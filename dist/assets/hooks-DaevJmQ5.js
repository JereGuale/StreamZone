const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ui-components-CeKtGgHu.js","assets/react-vendor-Y7T1HomI.js","assets/supabase-L-NHoLOp.js","assets/jspdf.es.min-Cj24ZQjq.js"])))=>i.map(i=>d[i]);
import{_ as J}from"./supabase-L-NHoLOp.js";import{r as s,i as de,k as ue,m as ge,n as me,S as ee,o as Y,p as pe,q as he,v as fe,w as Ee,x as Se,y as Ae,z as U,A as ve,s as B}from"./ui-components-CeKtGgHu.js";const Pe="+593984280334",ye="+593998799579";function Ce(y){const[C,p]=s.useState(!1),[O,x]=s.useState({isOpen:!1,message:""}),_=r=>{x({isOpen:!0,message:r})},A=()=>{x({isOpen:!1,message:""})},D=r=>{const{service:v,price:w,duration:u,devices:m,customer:h,phone:g,email:P,paymentMethod:f,notes:b}=r,N=u===1?"1 mes":`${u} meses`,I=P?`
ğŸ“§ *Email:* ${P}`:"",L=b?`
ğŸ“ *Nota:* ${b}`:"";return`ğŸ‘‹ Â¡Hola! Quiero confirmar mi compra en *StreamZone* ğŸ¿

ğŸ‘¤ *Mis Datos:*
â€¢ ${h}
â€¢ ${g}${I}

ğŸ›’ *Mi Pedido:*
â€¢ ğŸ¿ *Servicio:* ${v}
â€¢ â³ *Tiempo:* ${N}
â€¢ ğŸ“º *Pantallas:* ${m}
â€¢ ğŸ’³ *Pago:* ${f}
â€¢ ğŸ’µ *Total:* $${w}${L}

Quedo atento/a para enviar el comprobante de pago y recibir mis credenciales. Â¡Gracias! âœ¨`},n=r=>{const v=D(r),w=`https://api.whatsapp.com/send?phone=${Pe.replace("+","")}&text=${encodeURIComponent(v)}`,u=`https://api.whatsapp.com/send?phone=${ye.replace("+","")}&text=${encodeURIComponent(v)}`,m=document.createElement("div");m.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",m.innerHTML=`
      <div class="bg-white rounded-xl p-6 max-w-md mx-4 shadow-2xl">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold text-gray-800">Â¡Compra Registrada! ğŸ‰</h3>
          <button id="closeModal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4">
          <p class="text-orange-800 text-sm font-medium">âš ï¸ PASO OBLIGATORIO</p>
          <p class="text-orange-700 text-xs mt-1">Debes contactar por WhatsApp para confirmar tu compra y recibir las credenciales</p>
        </div>
        <p class="text-gray-600 mb-6">Selecciona un agente para continuar con tu compra:</p>
        <div class="space-y-3">
          <button id="agent1" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
            ğŸ‘¨â€ğŸ’¼ Agente 1 (+593 98 428 0334)
          </button>
          <button id="agent2" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
            ğŸ‘¨â€ğŸ’¼ Agente 2 (+593 99 879 9579)
          </button>
        </div>
      </div>
    `,document.body.appendChild(m);const h=()=>{try{m&&m.parentNode&&document.body.removeChild(m)}catch{console.log("Modal ya cerrado")}};document.getElementById("agent1")?.addEventListener("click",()=>{h(),setTimeout(()=>{try{window.open(w,"_blank")}catch{alert("No se pudo abrir WhatsApp automÃ¡ticamente. Por favor, contacta al Agente 1: +593 98 428 0334")}},100)}),document.getElementById("agent2")?.addEventListener("click",()=>{h(),setTimeout(()=>{try{window.open(u,"_blank")}catch{alert("No se pudo abrir WhatsApp automÃ¡ticamente. Por favor, contacta al Agente 2: +593 99 879 9579")}},100)}),document.getElementById("closeModal")?.addEventListener("click",h)};return{processPurchase:async r=>{p(!0);try{console.log("ğŸ›’ Procesando compra para usuario registrado:",r);const v={customer:r.customer||"Cliente StreamZone",phone:r.phone||"+593000000000",service:r.service||"Servicio Premium",price:r.price||10,duration:r.duration||1,devices:r.devices||1,total:r.total||10,paymentMethod:r.paymentMethod||"pichincha",notes:r.notes||"",email:r.email||"cliente@streamzone.com",start:r.start||new Date().toISOString().slice(0,10),end:r.end||new Date(Date.now()+720*60*60*1e3).toISOString().slice(0,10)};console.log("âœ… Datos garantizados para usuario registrado:",v),console.log("ğŸ¯ Mostrando panel de agentes..."),n(v);try{console.log("ğŸ’¾ Intentando guardar en BD en segundo plano..."),console.log("ğŸ” Buscando usuario existente por email:",r.email);const{data:w}=await de(r.email);let u=w?.id,m=w?.phone;if(u)console.log("âœ… Usuario encontrado por email:",u),console.log("ğŸ“± TelÃ©fono del usuario en BD:",m);else{console.log("ğŸ” Usuario no encontrado por email, buscando por telÃ©fono:",r.phone);const{data:h,error:g}=await ue(r.phone);if(h?.id)u=h.id,m=h.phone,console.log("âœ… Usuario encontrado por telÃ©fono:",u);else{console.log("ğŸ‘¤ Usuario no encontrado, creando nuevo usuario...");const P={name:r.customer,phone:r.phone,email:r.email||"sin-email@temp.com"},{data:f,error:b}=await ge(P);if(b){console.warn("âš ï¸ Error creando usuario:",b),console.error("âŒ NO SE PUEDE CONTINUAR SIN USUARIO VÃLIDO");return}else u=f?.id,m=f?.phone,console.log("âœ… Usuario creado exitosamente:",u)}}if(u){console.log("ğŸ¯ TENEMOS userId:",u);const h={customer:r.customer,phone:m||r.phone,service:r.service,start:r.start,end:r.end,months:r.duration,price:r.price||0,validated:!1};console.log("ğŸ“± TelÃ©fono del formulario:",r.phone),console.log("ğŸ“± TelÃ©fono de la BD (usado):",m||r.phone),console.log("ğŸ’¾ Guardando compra pendiente en BD (campos correctos):",h),console.log("ğŸ” Llamando a createPurchase con:",JSON.stringify(h,null,2));const{data:g,error:P}=await me(h);P?(console.error("âŒ Error guardando compra:",P),console.error("âŒ Detalles del error:",JSON.stringify(P,null,2)),console.error("âŒ Tipo de error:",typeof P),console.error("âŒ Mensaje del error:",P.message)):(console.log("âœ… Compra guardada como pendiente:",g),console.log("âœ… ID de la compra guardada:",g?.id),console.log("âœ… Validated status:",g?.validated),console.log("ğŸ¯ Â¡COMPRA GUARDADA EXITOSAMENTE! DeberÃ­a aparecer en admin."),console.log("ğŸ”„ Forzando recarga inmediata de compras pendientes..."),setTimeout(async()=>{try{const{getPendingPurchases:f}=await J(async()=>{const{getPendingPurchases:N}=await import("./ui-components-CeKtGgHu.js").then(I=>I.O);return{getPendingPurchases:N}},__vite__mapDeps([0,1,2])),b=await f();console.log("ğŸ”„ RESULTADO INMEDIATO de getPendingPurchases:",b),console.log("ğŸ”„ Compras pendientes encontradas:",b.data?.length||0)}catch(f){console.error("âŒ Error en recarga inmediata:",f)}},1e3))}else console.error("âŒ NO HAY userId - NO SE PUEDE GUARDAR LA COMPRA"),console.error("âŒ purchaseData:",r)}catch(w){console.warn("âš ï¸ Error en BD (no crÃ­tico):",w)}}catch(v){console.error("âŒ Error crÃ­tico:",v),_("Error al procesar la compra. Por favor, intÃ©ntalo de nuevo.")}finally{p(!1)}},isProcessing:C,generateWhatsAppMessage:D,errorModal:O,closeErrorModal:A}}function xe(y){const[C,p]=s.useState([]),[O,x]=s.useState([]),[_,A]=s.useState([]),[D,n]=s.useState([]),[R,r]=s.useState(null),[v,w]=s.useState(ee),[u,m]=s.useState(Y),[h,g]=s.useState(!1),[P,f]=s.useState(null),b=async()=>{try{const t=await Ae();if(t.data&&t.data.length>0){const i=new Set(Y.map(o=>o.id)),G=ee.map(o=>o.id),k=Y.map(o=>o.id),W=t.data.filter(o=>!o.is_combo&&!i.has(o.id)&&!o.id.startsWith("combo_")&&!o.name.toLowerCase().includes("combo")&&!o.name.includes(" + ")),Z=t.data.filter(o=>o.is_combo||i.has(o.id)||o.id.startsWith("combo_")||o.name.toLowerCase().includes("combo")||o.name.includes(" + "));W.sort((o,c)=>{const e=G.indexOf(o.id),l=G.indexOf(c.id);return e===-1&&l===-1?o.name.localeCompare(c.name):e===-1?1:l===-1?-1:e-l}),Z.sort((o,c)=>{const e=k.indexOf(o.id),l=k.indexOf(c.id);return e===-1&&l===-1?o.name.localeCompare(c.name):e===-1?1:l===-1?-1:e-l}),w(W),m(Z)}}catch(t){console.error("Error loading products from DB:",t)}},N=async()=>{g(!0),f(null);try{console.log("ğŸ”„ loadAllPurchasesFromSupabase: Iniciando carga...");const t=await Se();return console.log("ğŸ”„ loadAllPurchasesFromSupabase: Resultado recibido:",t),t.data&&Array.isArray(t.data)?(p(t.data),console.log("âœ… loadAllPurchasesFromSupabase: Todas las compras cargadas desde Supabase:",t.data.length),t.data.length>0&&console.log("ğŸ“‹ Primeras 3 compras:",t.data.slice(0,3).map(i=>({id:i.id,customer:i.customer,validated:i.validated,created_at:i.created_at}))),t.data):(console.warn("âš ï¸ loadAllPurchasesFromSupabase: No se pudieron cargar las compras desde Supabase"),p([]),[])}catch(t){return console.error("âŒ loadAllPurchasesFromSupabase: Error cargando compras desde Supabase:",t),f("Error cargando compras desde la base de datos"),p([]),[]}finally{g(!1)}},I=async()=>{try{console.log("ğŸ”„ loadPendingPurchases: Iniciando carga...");const t=await pe();return console.log("ğŸ”„ loadPendingPurchases: Resultado recibido:",t),t.data&&Array.isArray(t.data)?(x(t.data),console.log("âœ… loadPendingPurchases: Compras pendientes cargadas:",t.data.length),t.data):(console.log("âš ï¸ loadPendingPurchases: No hay datos o no es array, estableciendo array vacÃ­o"),x([]),[])}catch(t){return console.error("âŒ loadPendingPurchases: Error cargando compras pendientes:",t),x([]),[]}},L=async t=>{try{const i=await Ee(t);return i.data?(A(i.data),console.log("âœ… Compras activas del usuario cargadas:",i.data.length),i.data):(A([]),[])}catch(i){return console.error("âŒ Error cargando compras del usuario:",i),A([]),[]}},T=async()=>{try{const t=await fe(7);return t.data?(n(t.data),console.log("âœ… Servicios prÃ³ximos a vencer cargados:",t.data.length),t.data):(n([]),[])}catch(t){return console.error("âŒ Error cargando servicios prÃ³ximos a vencer:",t),n([]),[]}},$=async()=>{try{const t=await he();return t.data?(r(t.data),console.log("âœ… EstadÃ­sticas de renovaciones cargadas"),t.data):(r(null),null)}catch(t){return console.error("âŒ Error cargando estadÃ­sticas de renovaciones:",t),r(null),null}},F=async()=>{console.log("ğŸ”„ refreshAllStats: Iniciando recarga completa..."),g(!0),f(null);try{console.log("ğŸ”„ refreshAllStats: Cargando todas las compras..."),await N(),console.log("ğŸ”„ refreshAllStats: Cargando compras pendientes..."),await I(),console.log("ğŸ”„ refreshAllStats: Cargando servicios prÃ³ximos a vencer..."),await T(),console.log("ğŸ”„ refreshAllStats: Cargando estadÃ­sticas de renovaciones..."),await $(),await b(),console.log("âœ… refreshAllStats: Todas las estadÃ­sticas actualizadas desde Supabase")}catch(t){console.error("âŒ refreshAllStats: Error actualizando estadÃ­sticas:",t),f("Error actualizando estadÃ­sticas")}finally{g(!1)}};return s.useEffect(()=>{console.log("ğŸ”„ useSupabaseData: Iniciando carga de datos de admin..."),F()},[y]),s.useEffect(()=>{console.log("ğŸ”„ useSupabaseData: Cargando compras pendientes al inicio..."),(async()=>{const i=await I();console.log("ğŸ¯ RESULTADO INICIAL loadPendingPurchases:",i)})()},[]),s.useEffect(()=>{{console.log("ğŸ”„ useSupabaseData: Iniciando actualizaciÃ³n automÃ¡tica cada 5 segundos...");const t=setInterval(async()=>{console.log("ğŸ”„ ACTUALIZACIÃ“N AUTOMÃTICA: Recargando compras pendientes...");try{const i=await I();console.log("ğŸ”„ ACTUALIZACIÃ“N AUTOMÃTICA: Compras pendientes:",i?.length||0)}catch(i){console.error("âŒ Error en actualizaciÃ³n automÃ¡tica:",i)}},5e3);return()=>{console.log("ğŸ›‘ useSupabaseData: Deteniendo actualizaciÃ³n automÃ¡tica..."),clearInterval(t)}}},[y]),s.useEffect(()=>{A([])},[y]),s.useEffect(()=>{const t=i=>{i.key==="userPhone"&&i.newValue&&(console.log("ğŸ”„ TelÃ©fono de usuario cambiado, recargando compras..."),g(!0),L(i.newValue).finally(()=>g(!1)))};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[]),{allPurchases:C,pendingPurchases:O,userActivePurchases:_,expiringServices:D,renewalStats:R,services:v,combos:u,loading:h,error:P,loadAllPurchasesFromSupabase:N,loadPendingPurchases:I,loadUserActivePurchases:L,loadExpiringServices:T,loadRenewalStats:$,refreshAllStats:F,refreshUserPurchases:async t=>{console.log("ğŸ”„ Forzando recarga de compras del usuario:",t),g(!0);try{const i=await L(t);return console.log("âœ… Compras del usuario recargadas:",i?.length||0),i}catch(i){return console.error("âŒ Error recargando compras del usuario:",i),[]}finally{g(!1)}}}}const Ie=()=>{const[y,C]=s.useState(()=>U.load("userProfile",null)),[p,O]=s.useState(()=>!!U.load("adminLogged",!1)),[x,_]=s.useState(()=>U.load("userProfileData",null)),[A,D]=s.useState(()=>U.load("allPurchases",[])),[n,R]=s.useState("login"),[r,v]=s.useState(""),[w,u]=s.useState(""),[m,h]=s.useState("");return s.useEffect(()=>{U.save("userProfile",y)},[y]),s.useEffect(()=>{U.save("userProfileData",x)},[x]),s.useEffect(()=>{U.save("allPurchases",A)},[A]),s.useEffect(()=>{U.save("adminLogged",p)},[p]),{user:y,setUser:C,adminLogged:p,setAdminLogged:O,userProfile:x,setUserProfile:_,allPurchases:A,setAllPurchases:D,authStep:n,setAuthStep:R,resetEmail:r,setResetEmail:v,resetToken:w,setResetToken:u,resetCode:m,setResetCode:h,handleLogin:T=>{C(T)},handleLogout:()=>{C(null),_(null)},handleAdminLogin:T=>{T&&O(!0)},handleAdminLogout:()=>{O(!1)},handleForgotPassword:(T,$)=>{v(T),u($),R("code")},handleCodeVerified:T=>{u(T),R("newpassword")},handlePasswordReset:()=>{R("login")}}},we=[{email:"gualejeremi@gmail.com",role:"principal",canGenerateKeys:!1,canDeleteOthers:!0,isProtected:!0}],Oe=(y=[],C,p)=>{const[O,x]=s.useState(we),[_,A]=s.useState(!1),[D,n]=s.useState(""),[R,r]=s.useState("dashboard"),[v,w]=s.useState(!1),[u,m]=s.useState(!1),[h,g]=s.useState(!1),[P,f]=s.useState(!1),[b,N]=s.useState(null),[I,L]=s.useState(!1),[T,$]=s.useState(null),F=O.map(o=>o.email);return{adminUsers:O,setAdminUsers:x,loading:_,setLoading:A,msg:D,setMsg:n,adminView:R,setAdminView:r,adminDrawerOpen:v,setAdminDrawerOpen:w,adminMenuOpen:u,setAdminMenuOpen:m,adminRegisterPurchaseOpen:h,setAdminRegisterPurchaseOpen:g,editPurchaseOpen:P,setEditPurchaseOpen:f,editingPurchase:b,setEditingPurchase:N,approvePurchaseOpen:I,setApprovePurchaseOpen:L,selectedPurchase:T,setSelectedPurchase:$,adminEmails:F,handleToggleValidate:async o=>{const c=y.find(l=>l.id===o);if(!c)return;if(!c.validated){$(c),L(!0);return}const e="invalidar";if(!B){n("âŒ Error: Base de datos no disponible"),setTimeout(()=>n(""),3e3);return}if(confirm(`Â¿EstÃ¡s seguro de que quieres ${e} la compra de ${c.customer} - ${c.service}?`)){A(!0);try{const{error:l}=await B.from("purchases").update({validated:!1}).eq("id",o);if(l)throw l;C(E=>E.map(S=>S.id===o?{...S,validated:!1}:S)),n("âœ…âœ¨ Compra invalidada exitosamente âœ¨âœ…"),setTimeout(()=>n(""),3e3),p&&await p()}catch(l){console.error("Error al actualizar compra:",l),n("âŒ Error al actualizar la compra"),setTimeout(()=>n(""),3e3)}finally{A(!1)}}},handleDeletePurchase:async o=>{const c=y.find(l=>l.id===o);if(!c)return;const e=c.validated?`âš ï¸ ADVERTENCIA: Â¿EstÃ¡s seguro de que quieres ELIMINAR PERMANENTEMENTE a ${c.customer}?

Escribe "ELIMINAR" para confirmar:`:`Â¿EstÃ¡s seguro de que quieres rechazar la compra de ${c.customer}?`;if(confirm(e)){if(!B){n("âŒ Error: Base de datos no disponible"),setTimeout(()=>n(""),3e3);return}if(!(c.validated&&prompt("Escribe exactamente: ELIMINAR")!=="ELIMINAR")){A(!0);try{const{error:l}=await B.from("purchases").delete().eq("id",o);if(l)throw l;C(E=>E.filter(S=>S.id!==o)),n("âœ…âœ¨ Compra eliminada exitosamente âœ¨âœ…"),setTimeout(()=>n(""),3e3),p&&await p()}catch(l){console.error("Error al eliminar compra:",l),n("âŒ Error al eliminar la compra"),setTimeout(()=>n(""),3e3)}finally{A(!1)}}}},handleEditPurchase:o=>{N(o),f(!0)},handleReminderPurchase:o=>{const c=new Date,e=new Date(o.end),l=Math.ceil((e.getTime()-c.getTime())/(1e3*60*60*24));let E=`â˜… StreamZone â˜…
Â¡Hola ${o.customer}! ğŸ¬

`;l<=0?E+=`Tu servicio ${o.service} vencio el ${o.end}. âš ï¸

Responde para reactivarlo. Â¡Gracias! âœ¨`:E+=`Tu servicio ${o.service} vence el ${o.end} (${l} dias). â°

Responde para renovar. Â¡Gracias! âœ¨`;const V=`https://api.whatsapp.com/send?phone=${o.phone.replace(/\D/g,"")}&text=${encodeURIComponent(E)}`;try{window.open(V,"_blank"),n(`ğŸ“±âœ¨ Recordatorio enviado a ${o.customer}`),setTimeout(()=>n(""),5e3)}catch{n("âŒ Error al abrir WhatsApp"),setTimeout(()=>n(""),3e3)}},handleApproveSuccess:async()=>{if(C(o=>o.map(c=>c.id===T?.id?{...c,validated:!0}:c)),p)try{await p()}catch(o){console.error("âŒ Error recargando datos:",o)}},handleUpdatePurchase:async(o,c)=>{try{const{error:e}=await ve(o,c);if(e)throw e;C(l=>l.map(E=>E.id===o?{...E,...c}:E)),n("âœ… Compra actualizada correctamente"),setTimeout(()=>n(""),5e3),p&&await p()}catch(e){console.error("âŒ Error actualizando compra:",e),n(`âŒ Error: ${e.message}`),setTimeout(()=>n(""),5e3)}},handleExportCSV:async()=>{try{const o=(await J(async()=>{const{default:a}=await import("./jspdf.es.min-Cj24ZQjq.js").then(d=>d.j);return{default:a}},__vite__mapDeps([3,2,1]))).default,c=(await J(async()=>{const{default:a}=await import("./jspdf.plugin.autotable-DZlIrCiz.js");return{default:a}},[])).default,e=new o,l=e.internal.pageSize.width,E=new Date,S=[31,41,55],V=[37,99,235],Q=[5,150,105];e.setFillColor(S[0],S[1],S[2]),e.rect(0,0,l,45,"F");try{e.addImage("/logo_app.png","PNG",15,7,30,30)}catch{e.setTextColor(255,255,255),e.setFontSize(24),e.setFont("helvetica","bold"),e.text("SZ",20,25)}e.setTextColor(255,255,255),e.setFontSize(22),e.setFont("helvetica","bold"),e.text("STREAMZONE",50,20),e.setFontSize(10),e.setFont("helvetica","normal"),e.text("SISTEMA INTEGRAL DE GESTIÃ“N OPERATIVA",50,28),e.setFontSize(9),e.text(`Generado: ${E.toLocaleDateString("es-ES")} ${E.toLocaleTimeString("es-ES")}`,l-20,20,{align:"right"}),e.text("Documento Administrativo Original",l-20,26,{align:"right"});const j=y.filter(a=>a.validated),te=j.filter(a=>new Date(a.end)>=E).length,ae=j.reduce((a,d)=>a+(Number(d.price)||0),0),re=y.filter(a=>!a.validated).length,q=(a,d,M,ie,ce,H)=>{e.setFillColor(243,244,246),e.rect(a,d,M,24,"F"),e.setDrawColor(209,213,219),e.rect(a,d,M,24,"D"),e.setFontSize(8),e.setTextColor(75,85,99),e.setFont("helvetica","bold"),e.text(ie.toUpperCase(),a+5,d+8),e.setFontSize(14),e.setTextColor(H[0],H[1],H[2]),e.text(ce,a+5,d+18)},z=(l-50)/3;q(20,55,z,"Capital en Caja",`$${ae.toLocaleString()}`,Q),q(25+z,55,z,"Suscripciones Activas",te.toString(),V),q(30+z*2,55,z,"Ventas por Validar",re.toString(),[220,38,38]),e.setTextColor(S[0],S[1],S[2]),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("RENDIMIENTO POR PLATAFORMA",20,95);const se=j.reduce((a,d)=>{const M=d.service||"Otros";return a[M]||(a[M]={count:0,revenue:0}),a[M].count+=1,a[M].revenue+=Number(d.price)||0,a},{}),ne=Object.entries(se).filter(([,a])=>a.count>0).sort((a,d)=>d[1].revenue-a[1].revenue).map(([a,d])=>[a.toUpperCase(),d.count.toString(),`$${d.revenue.toLocaleString()}`]);c(e,{head:[["PLATAFORMA","VENTAS EXITOSAS","TOTAL GENERADO"]],body:ne,startY:102,margin:{left:20,right:20},styles:{fontSize:8,cellPadding:4},headStyles:{fillColor:V,textColor:[255,255,255],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right",fontStyle:"bold"}}});const X=e.lastAutoTable.finalY+15;e.setTextColor(S[0],S[1],S[2]),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("HISTORIAL DETALLADO DE TRANSACCIONES",20,X);const le=y.map(a=>{const d=new Date(a.end)>=E,M=a.validated?d?"VIGENTE":"VENCIDO":"PENDIENTE";return[(a.customer||"N/A").toUpperCase(),a.service||"N/A",a.start||"-",a.end||"-",`$${(Number(a.price)||0).toLocaleString()}`,M]});c(e,{head:[["CLIENTE","SERVICIO","FECHA INICIO","VENCIMIENTO","PRECIO","ESTADO"]],body:le,startY:X+7,margin:{left:20,right:20},styles:{fontSize:7,cellPadding:3,textColor:[31,41,55],lineColor:[229,231,235],lineWidth:.1},headStyles:{fillColor:S,textColor:[255,255,255],fontStyle:"bold",halign:"center"},columnStyles:{2:{halign:"center"},3:{halign:"center"},4:{halign:"right",fontStyle:"bold"},5:{halign:"center",fontStyle:"bold"}},alternateRowStyles:{fillColor:[252,253,255]},didParseCell:a=>{if(a.section==="body"&&a.column.index===5){const d=a.cell.raw;d==="VIGENTE"&&(a.cell.styles.textColor=[5,150,105]),d==="PENDIENTE"&&(a.cell.styles.textColor=[217,119,6]),d==="VENCIDO"&&(a.cell.styles.textColor=[220,38,38])}}});const K=e.getNumberOfPages();for(let a=1;a<=K;a++)e.setPage(a),e.setFontSize(8),e.setTextColor(156,163,175),e.text(`Generado para StreamZone Admin â€¢ PÃ¡gina ${a} de ${K}`,20,e.internal.pageSize.height-10),e.text("StreamZone CRM - Control y Auditoria Financiera",l-20,e.internal.pageSize.height-10,{align:"right"});e.save(`StreamZone_Report_${E.toISOString().split("T")[0]}.pdf`),n("âœ… Reporte Ejecutivo con Logo y Categorias generado"),setTimeout(()=>n(""),4e3)}catch(o){console.error("Error generando PDF:",o),n("âŒ Error al generar el reporte corporativo"),setTimeout(()=>n(""),3e3)}}}};export{xe as a,Oe as b,Ce as c,Ie as u};

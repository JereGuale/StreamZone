import{r as G,a as H}from"./react-vendor-Y7T1HomI.js";import{c as Y}from"./supabase-L-NHoLOp.js";var T={exports:{}},E={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z;function K(){if(z)return E;z=1;var s=G(),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(p,c,d){var g,b={},v=null,S=null;d!==void 0&&(v=""+d),c.key!==void 0&&(v=""+c.key),c.ref!==void 0&&(S=c.ref);for(g in c)r.call(c,g)&&!i.hasOwnProperty(g)&&(b[g]=c[g]);if(p&&p.defaultProps)for(g in c=p.defaultProps,c)b[g]===void 0&&(b[g]=c[g]);return{$$typeof:n,type:p,key:v,ref:S,props:b,_owner:a.current}}return E.Fragment=o,E.jsx=l,E.jsxs=l,E}var q;function D(){return q||(q=1,T.exports=K()),T.exports}var e=D(),N=G();const pe=H(N),V=s=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"USD"}).format(s),he={load(s,n){try{return JSON.parse(localStorage.getItem(s)||JSON.stringify(n))}catch{return n}},save(s,n){localStorage.setItem(s,JSON.stringify(n))},del(s){localStorage.removeItem(s)}};function fe(s,n){const o=new Date(s),a=new Date(n).getTime()-o.getTime();return Math.floor(a/(1e3*60*60*24))}function t(s,n,o){return s?o:n}const Q=s=>{const n=new Date,r=new Date(s).getTime()-n.getTime();return Math.round(r/(1e3*60*60*24))},ye=(s,n)=>{const o=new Date(s);o.setHours(0,0,0,0);const r=new Date(n);r.setHours(0,0,0,0);const a=r.getTime()-o.getTime();return Math.ceil(a/(1e3*60*60*24))},ve=s=>{const n=Q(s);return n<0?{status:"expired",color:"text-red-600",icon:"❌",message:"Servicio Caducado"}:n===0?{status:"expires-today",color:"text-red-600",icon:"⚠️",message:"Caduca Hoy"}:{status:"active",color:"text-red-600",icon:"⏰",message:`${n} ${n===1?"día":"días"} restantes`}};function F(s){return s.replace(/[^\d]/g,"")}function k(s,n="+593"){const o=F(s);return o.length===0?"":o.startsWith("593")&&o.length>=9?`+${o}`:o.length===9?`${n}${o}`:o.length===12&&o.startsWith("593")?`+${o}`:o}function M(s,n="593"){const o=F(s);return o.length===0?"":o.startsWith("593")&&o.length>=9?o:o.length===9?`${n}${o}`:o}function we(s){return{netflix:"Series originales, thrillers, documentales",disney:"Marvel, Star Wars, Pixar, familias",max:"HBO premium, series épicas, películas",prime:"Exclusivas, blockbusters, Amazon",spotify:"Música, podcasts, audiolibros",paramount:"Paramount, Nickelodeon, MTV",apple:"Originales Apple, 4K premium"}[s]||"Contenido premium de entretenimiento"}const U=[{id:"netflix",name:"Netflix",price:4,billing:"monthly",color:"bg-red-600",logo:"N"},{id:"disney_premium",name:"Disney+ Premium",price:3.75,billing:"monthly",color:"bg-blue-600",logo:"D+"},{id:"disney_standard",name:"Disney+ Standard",price:3.25,billing:"monthly",color:"bg-blue-500",logo:"D+"},{id:"max",name:"Max",price:3,billing:"monthly",color:"bg-purple-700",logo:"MAX"},{id:"vix",name:"ViX",price:2.5,billing:"monthly",color:"bg-orange-500",logo:"ViX"},{id:"prime",name:"Prime Video",price:3,billing:"monthly",color:"bg-sky-700",logo:"PV"},{id:"youtube_premium",name:"YouTube Premium",price:3.35,billing:"monthly",color:"bg-red-700",logo:"YT"},{id:"paramount",name:"Paramount+",price:2.75,billing:"monthly",color:"bg-indigo-600",logo:"P+"},{id:"chatgpt",name:"ChatGPT",price:4,billing:"monthly",color:"bg-zinc-800",logo:"GPT"},{id:"crunchy",name:"Crunchyroll",price:2.5,billing:"monthly",color:"bg-orange-600",logo:"CR"},{id:"spotify",name:"Spotify",price:3.5,billing:"monthly",color:"bg-emerald-600",logo:"SP"},{id:"deezer",name:"Deezer",price:3,billing:"monthly",color:"bg-blue-700",logo:"DZ"},{id:"apple_tv",name:"Apple TV+",price:3.5,billing:"monthly",color:"bg-neutral-900",logo:"ATV"},{id:"canva_pro",name:"Canva Pro",price:2,billing:"monthly",color:"bg-indigo-500",logo:"C"},{id:"canva_pro_annual",name:"Canva Pro (1 año)",price:17.5,billing:"annual",color:"bg-indigo-600",logo:"C"},{id:"microsoft365",name:"Microsoft 365 (1 año)",price:15,billing:"annual",color:"bg-blue-500",logo:"M365"},{id:"autodesk",name:"Autodesk (1 año)",price:12.5,billing:"annual",color:"bg-zinc-700",logo:"AD"},{id:"office365",name:"Office 365 (1 año)",price:15,billing:"annual",color:"bg-blue-600",logo:"O365"}],B=[{id:"netflix_disney_std",name:"Netflix + Disney Estándar",price:6,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-500",logo:"N+D"},{id:"netflix_disney_premium",name:"Netflix + Disney Premium",price:6.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-600",logo:"N+D+"},{id:"netflix_max",name:"Netflix + Max",price:6,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-purple-700",logo:"N+MAX"},{id:"disney_max",name:"Disney + Max",price:5.5,billing:"monthly",color:"bg-gradient-to-r from-blue-600 to-purple-700",logo:"D+MAX"},{id:"spotify_disney",name:"Spotify + Disney",price:5,billing:"monthly",color:"bg-gradient-to-r from-emerald-600 to-blue-500",logo:"SP+D+"},{id:"netflix_spotify_disney_std",name:"Netflix + Spotify + Disney Standar",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-blue-500",logo:"N+SP+D"},{id:"netflix_spotify_prime",name:"Netflix + Spotify + Prime Video",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-sky-700",logo:"N+SP+PV"}],I="https://gfjwebngyzfftakbbmji.supabase.co",A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdmandlYm5neXpmZnRha2JibWppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMjI1MzEsImV4cCI6MjA3Mzg5ODUzMX0.niC_FqHiHZ4EMNW86VpXX_ouIVsxftfXV8JgZxuCBGE";console.log("🔍 Debug - Variables hardcodeadas:");console.log("URL:",I);console.log("ANON_KEY:",A.substring(0,20)+"...");console.log("✅ Variables configuradas correctamente");const W=I.includes("supabase.co")&&A.startsWith("eyJ")&&!I.includes("tu-proyecto")&&!A.includes("tu_clave_anonima");let x=null;if(W)try{x=Y(I,A),console.log("[StreamZone] Supabase configurado correctamente")}catch(s){console.error("[StreamZone] Error configurando Supabase:",s),x=null}else console.warn("[StreamZone] Supabase no configurado. Para habilitar el guardado en la nube, crea .env.local con VITE_SUPABASE_URL y VITE_SUPABASE_ANON_KEY");const ee=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede crear usuario"),{data:null,error:new Error("Supabase no configurado")};try{if(console.log("📝 Creando usuario en Supabase:",s),!s.name||!s.phone||!s.email)throw new Error("Datos de usuario incompletos");const n={name:s.name.trim(),phone:s.phone.trim(),email:s.email.trim().toLowerCase()};console.log("📝 Datos limpios para insertar:",n);const{data:o,error:r}=await x.from("users").insert([n]).select().single();if(r)throw console.error("❌ Error de Supabase al crear usuario:",r),console.error("❌ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return console.log("✅ Usuario creado exitosamente:",o),{data:o,error:null}}catch(n){return console.error("❌ Error creating user:",n),{data:null,error:n}}},re=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede obtener usuario"),{data:null,error:new Error("Supabase no configurado")};try{console.log("🔍 Buscando usuario con teléfono:",s);const n=s.trim(),{data:o,error:r}=await x.from("users").select("*").eq("phone",n).single();if(r&&r.code!=="PGRST116")throw console.error("❌ Error de Supabase al buscar usuario:",r),console.error("❌ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return r&&r.code==="PGRST116"?(console.log("ℹ️ Usuario no encontrado (esto es normal para nuevos usuarios)"),{data:null,error:null}):(console.log("✅ Usuario encontrado:",o),{data:o,error:null})}catch(n){return console.error("❌ Error getting user by phone:",n),{data:null,error:n}}},te=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede crear compra"),{data:null,error:new Error("Supabase no configurado")};try{console.log("💾 createPurchase: Creando compra en Supabase:",s),console.log("💾 createPurchase: validated =",s.validated);const n={customer:s.customer||"",phone:s.phone||"",service:s.service||"",start:s.start||new Date().toISOString().split("T")[0],end:s.end||new Date().toISOString().split("T")[0],months:s.months||1,validated:s.validated!==void 0?s.validated:!1,service_email:s.service_email||null,service_password:s.service_password||null,admin_notes:s.admin_notes||null,approved_by:s.approved_by||null,approved_at:s.approved_at||null,auto_renewal:s.auto_renewal||!1,renewal_reminder_sent:s.renewal_reminder_sent||!1,renewal_attempts:s.renewal_attempts||0,last_renewal_attempt:s.last_renewal_attempt||null,renewal_status:s.renewal_status||"none",original_purchase_id:s.original_purchase_id||null,is_renewal:s.is_renewal||!1};console.log("💾 createPurchase: Datos limpios:",n);const{data:o,error:r}=await x.from("purchases").insert([n]).select().maybeSingle();if(r)throw console.error("❌ Error de Supabase al crear compra:",r),console.error("❌ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),console.error("❌ Datos que causaron el error:",n),console.error("❌ Stack trace completo:",r.stack),r;return console.log("✅ createPurchase: Compra creada exitosamente:",o),{data:o?.[0]||o,error:null}}catch(n){return console.error("❌ Error creating purchase:",n),{data:null,error:n}}},oe=async(s,n)=>{console.log("🔧 ===== updatePurchase INICIADO ====="),console.log("🆔 ID recibido:",s),console.log("📝 updateData recibido:",n),console.log("📊 Tipo de ID:",typeof s),console.log("📊 Tipo de updateData:",typeof n);try{if(!x)throw console.error("❌ Supabase no configurado"),new Error("Supabase no configurado");console.log("💾 Ejecutando update en Supabase..."),console.log("📤 Query:",{table:"purchases",id:s,updateData:n});const{data:o,error:r}=await x.from("purchases").update(n).eq("id",s).select().single();if(console.log("📥 Respuesta de Supabase:",{data:o,error:r}),r)throw console.error("❌ Error de Supabase:",r),console.error("❌ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return console.log("✅ Update exitoso en Supabase:",o),console.log("🎉 ===== updatePurchase COMPLETADO ====="),{data:o,error:null}}catch(o){return console.error("❌ ===== ERROR EN updatePurchase ====="),console.error("❌ Error updating purchase:",o),console.error("❌ Stack trace:",o.stack),{data:null,error:o}}},se=async s=>{if(!x)return console.warn("Supabase no configurado, saltando sincronización de servicios"),{data:[],error:null};try{const{data:n,error:o}=await x.from("services").select("*");if(o)throw o;const r=new Map(n?.map(i=>[i.name,i])||[]),a=s.filter(i=>!r.has(i.name));if(a.length>0){const{data:i,error:l}=await x.from("services").insert(a.map(p=>({id:p.id,name:p.name,price:p.price,billing:p.billing,color:p.color,logo:p.logo}))).select();if(l)throw l;console.log(`Sincronizados ${a.length} servicios nuevos`)}return{data:a,error:null}}catch(n){return console.error("Error syncing services:",n),{data:[],error:n}}},ae=async()=>{if(!x)return console.warn("Supabase no configurado, no se pueden obtener todas las compras"),{data:null,error:new Error("Supabase no configurado")};try{console.log("🔍 getAllPurchases: Obteniendo todas las compras...");const{data:s,error:n}=await x.from("purchases").select("*").order("created_at",{ascending:!1});if(n)throw console.error("❌ Error en getAllPurchases:",n),n;return console.log("✅ getAllPurchases: Obtenidas",s?.length||0,"compras totales"),{data:s,error:null}}catch(s){return console.error("❌ Error getting all purchases:",s),{data:null,error:s}}},J=async(s,n,o,r,a)=>{if(console.log("🔍 approvePurchase: Verificando configuración de Supabase..."),console.log("🔍 supabase client:",x),console.log("🔍 isSupabaseConfigured:",W),!x)return console.error("❌ Supabase no configurado, no se puede aprobar compra"),{data:null,error:new Error("Supabase no configurado")};try{console.log("🔄 Supabase: Aprobando compra...",{purchaseId:s,serviceEmail:n,servicePassword:o?"***":"undefined",adminNotes:r,approvedBy:a});const{data:i,error:l}=await x.from("purchases").update({validated:!0,service_email:n,service_password:o,admin_notes:r,approved_by:a}).eq("id",s).select().single();if(l)throw console.error("❌ Supabase Error:",l),l;return console.log("✅ Supabase: Compra aprobada exitosamente:",i),{data:i,error:null}}catch(i){return console.error("❌ Error approving purchase:",i),{data:null,error:i}}},ne=async()=>{if(!x)return console.warn("Supabase no configurado, no se puede obtener compras pendientes"),{data:null,error:new Error("Supabase no configurado")};try{console.log("🔍 getPendingPurchases: DIAGNÓSTICO COMPLETO...");const{count:s,error:n}=await x.from("purchases").select("*",{count:"exact",head:!0});console.log("📊 Total compras en BD:",s);const{count:o,error:r}=await x.from("purchases").select("*",{count:"exact",head:!0}).eq("validated",!1);console.log("⏳ Compras pendientes en BD:",o);const{data:a,error:i}=await x.from("purchases").select("id, customer, validated, created_at").order("created_at",{ascending:!1}).limit(10);console.log("📋 Últimas 10 compras:",a?.map(c=>({id:c.id,customer:c.customer,validated:c.validated,created_at:c.created_at})));let{data:l,error:p}=await x.from("purchases").select("*").eq("validated",!1).order("created_at",{ascending:!1});if(p){console.warn("⚠️ Error en consulta principal, intentando consulta básica:",p);const{data:c,error:d}=await x.from("purchases").select("id, customer, phone, service, validated, created_at, start, end, months").eq("validated",!1).order("created_at",{ascending:!1});if(d)throw console.error("❌ Error también en consulta básica:",d),d;l=c,p=null}return console.log("✅ getPendingPurchases: RESULTADO FINAL - Encontradas",l?.length||0,"compras pendientes"),l&&l.length>0?console.log("📋 Compras pendientes encontradas:",l.map(c=>({id:c.id,customer:c.customer,validated:c.validated,created_at:c.created_at}))):console.log("❌ NO SE ENCONTRARON COMPRAS PENDIENTES"),{data:l,error:null}}catch(s){return console.error("❌ Error getting pending purchases:",s),{data:null,error:s}}},le=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede obtener compras del usuario"),{data:null,error:new Error("Supabase no configurado")};try{console.log("🔍 Buscando compras activas para teléfono:",s);let n=s.trim();n.startsWith("+")||(n="+593"+n.replace(/[^\d]/g,"")),console.log("📞 Teléfono normalizado:",n);let{data:o,error:r}=await x.from("purchases").select("*").eq("phone",n).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});if(r)throw r;if(console.log("✅ Compras encontradas con teléfono exacto:",o?.length||0),!o||o.length===0){console.log("🔍 No se encontraron compras, intentando otros formatos...");const a=s.replace(/[^\d]/g,"");console.log("📞 Intentando sin código de país:",a);const{data:i,error:l}=await x.from("purchases").select("*").eq("phone",a).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});if(!l&&i&&i.length>0&&(console.log("✅ Compras encontradas sin código de país:",i.length),o=i),!o||o.length===0){const p="+593"+a;console.log("📞 Intentando con +593:",p);const{data:c,error:d}=await x.from("purchases").select("*").eq("phone",p).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});!d&&c&&c.length>0&&(console.log("✅ Compras encontradas con +593:",c.length),o=c)}}return console.log("📊 Total de compras activas encontradas:",o?.length||0),o&&o.length>0&&console.log("📋 Compras encontradas:",o.map(a=>({id:a.id,customer:a.customer,service:a.service,phone:a.phone,end:a.end}))),{data:o,error:null}}catch(n){return console.error("❌ Error getting user active purchases:",n),{data:null,error:n}}},ie=async(s=7)=>{if(!x)return console.warn("Supabase no configurado, no se puede obtener servicios próximos a vencer"),{data:null,error:new Error("Supabase no configurado")};try{const{data:n,error:o}=await x.rpc("get_expiring_services",{days_ahead:s});if(o)throw o;return{data:n,error:null}}catch(n){return console.error("Error getting expiring services:",n),{data:null,error:n}}},de=async()=>{if(!x)return console.warn("Supabase no configurado, no se pueden obtener estadísticas"),{data:null,error:new Error("Supabase no configurado")};try{const{data:s,error:n}=await x.from("purchases").select("auto_renewal, is_renewal, end, validated");if(n)throw n;return{data:{totalPurchases:s.length,autoRenewalEnabled:s.filter(r=>r.auto_renewal).length,renewalPurchases:s.filter(r=>r.is_renewal).length,expiringThisWeek:s.filter(r=>{const a=new Date(r.end),i=new Date,l=new Date(i.getTime()+10080*60*1e3);return a>=i&&a<=l&&r.validated}).length,expiredServices:s.filter(r=>new Date(r.end)<new Date&&r.validated).length},error:null}}catch(s){return console.error("Error getting renewal stats:",s),{data:null,error:s}}},X=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede buscar usuario"),{data:null,error:new Error("Supabase no configurado")};try{const{data:n,error:o}=await x.from("users").select("*").eq("email",s.toLowerCase().trim()).single();if(o&&o.code!=="PGRST116")throw o;return{data:n,error:null}}catch(n){return console.error("Error buscando usuario por email:",n),{data:null,error:n}}},ce=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede generar token"),{data:null,error:new Error("Supabase no configurado")};try{if(!(await X(s)).data)return{data:null,error:{message:`No existe un usuario con el email: ${s}. Verifica que el email sea correcto o crea una cuenta primero.`}};const o=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r=new Date(Date.now()+1800*1e3),{data:a,error:i}=await x.from("users").update({reset_token:o,reset_token_expires:r.toISOString()}).eq("email",s.toLowerCase().trim()).select().single();if(i)throw i;return{data:{token:o,user:a},error:null}}catch(n){return console.error("Error generando token de recuperación:",n),{data:null,error:n}}},Z=async s=>{if(!x)return console.warn("Supabase no configurado, no se puede verificar token"),{data:null,error:new Error("Supabase no configurado")};try{const{data:n,error:o}=await x.from("users").select("*").eq("reset_token",s).gt("reset_token_expires",new Date().toISOString()).single();if(o&&o.code!=="PGRST116")throw o;return{data:n,error:null}}catch(n){return console.error("Error verificando token:",n),{data:null,error:n}}},ue=async(s,n)=>{if(!x)return console.warn("Supabase no configurado, no se puede restablecer contraseña"),{data:null,error:new Error("Supabase no configurado")};try{if(!(await Z(s)).data)return{data:null,error:{message:"Token inválido o expirado"}};const{data:r,error:a}=await x.from("users").update({password:n,reset_token:null,reset_token_expires:null}).eq("reset_token",s).select().single();if(a)throw a;return{data:r,error:null}}catch(o){return console.error("Error restableciendo contraseña:",o),{data:null,error:o}}},me=async(s,n)=>{if(!x)return console.warn("Supabase no configurado, no se puede hacer login"),{data:null,error:new Error("Supabase no configurado")};try{const{data:o,error:r}=await x.from("users").select("*").eq("email",s.toLowerCase().trim()).eq("password",n).single();if(r&&r.code!=="PGRST116")throw r;return{data:o,error:null}}catch(o){return console.error("Error en login:",o),{data:null,error:o}}},je=Object.freeze(Object.defineProperty({__proto__:null,approvePurchase:J,createPurchase:te,createUser:ee,generateResetToken:ce,getAllPurchases:ae,getExpiringServices:ie,getPendingPurchases:ne,getRenewalStats:de,getUserActivePurchases:le,getUserByEmail:X,getUserByPhone:re,loginUser:me,resetPassword:ue,get supabase(){return x},syncServices:se,updatePurchase:oe,verifyResetToken:Z},Symbol.toStringTag,{value:"Module"})),ge=[{code:"+593",name:"Ecuador",flag:"🇪🇨"},{code:"+1",name:"Estados Unidos",flag:"🇺🇸"},{code:"+1",name:"Canadá",flag:"🇨🇦"},{code:"+52",name:"México",flag:"🇲🇽"},{code:"+54",name:"Argentina",flag:"🇦🇷"},{code:"+55",name:"Brasil",flag:"🇧🇷"},{code:"+56",name:"Chile",flag:"🇨🇱"},{code:"+57",name:"Colombia",flag:"🇨🇴"},{code:"+51",name:"Perú",flag:"🇵🇪"},{code:"+58",name:"Venezuela",flag:"🇻🇪"},{code:"+34",name:"España",flag:"🇪🇸"},{code:"+49",name:"Alemania",flag:"🇩🇪"},{code:"+33",name:"Francia",flag:"🇫🇷"},{code:"+44",name:"Reino Unido",flag:"🇬🇧"},{code:"+39",name:"Italia",flag:"🇮🇹"},{code:"+86",name:"China",flag:"🇨🇳"},{code:"+81",name:"Japón",flag:"🇯🇵"},{code:"+82",name:"Corea del Sur",flag:"🇰🇷"},{code:"+91",name:"India",flag:"🇮🇳"},{code:"+61",name:"Australia",flag:"🇦🇺"}];function Ne({open:s,onClose:n,service:o,user:r,isDark:a,onPurchase:i}){const[l,p]=N.useState(""),[c,d]=N.useState(1),[g,b]=N.useState(1),[v,S]=N.useState("");if(!s||!o)return null;const $=o.billing==="annual",_=o.price*c*g,P=()=>{if(console.log("🛒 Iniciando compra para usuario registrado..."),!r){console.warn("⚠️ Usuario no registrado - compra bloqueada");return}const m={name:r.name||"Cliente",phone:r.phone||"+593000000000",email:r.email||"cliente@streamzone.com"};let h=m.phone;h.startsWith("+")||(h="+593"+h.replace(/[^\d]/g,""));const j=o?.name||"Servicio Premium",u=o?.price||10,y=c>0?c:1,w=g>0?g:1,f={service:j,price:u,duration:y,devices:w,total:u*y*w,paymentMethod:"pichincha",notes:v||"",customer:m.name,phone:h,email:m.email,start:new Date().toISOString().slice(0,10),end:new Date(Date.now()+($?y*365:y*30)*24*60*60*1e3).toISOString().slice(0,10)};console.log("✅ Datos de compra garantizados:",f);try{i(f),console.log("🎉 Compra procesada exitosamente"),n()}catch(C){console.warn("⚠️ Error en onPurchase, pero continuando con panel de agentes:",C),n()}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-md p-2 sm:p-4",onClick:n,children:e.jsxs("div",{className:`w-full max-w-xs sm:max-w-md md:max-w-lg max-h-[95vh] sm:max-h-[90vh] rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-2xl overflow-y-auto border-2 ${t(a,"bg-white border-gray-200","bg-zinc-900 border-zinc-700 text-zinc-100")}`,onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"mb-3 sm:mb-4 md:mb-6 flex items-center justify-between",children:[e.jsx("h3",{className:`text-lg sm:text-xl md:text-2xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Completar Compra"}),e.jsx("button",{onClick:n,className:`w-8 h-8 sm:w-9 sm:h-9 rounded-full flex items-center justify-center text-lg font-bold transition-colors shadow-md ${t(a,"text-gray-600 hover:text-gray-800 hover:bg-gray-100 border border-gray-300","text-zinc-200 hover:text-white hover:bg-zinc-800 border border-zinc-600")}`,children:"×"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-xl sm:rounded-2xl p-3 sm:p-4 border ${t(a,"bg-gray-50 border-gray-200","bg-zinc-800 border-zinc-600")}`,children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:`h-12 w-12 sm:h-16 sm:w-16 ${o.color} rounded-xl text-white grid place-content-center text-lg sm:text-2xl font-bold shadow-lg`,children:o.logo}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`text-base sm:text-lg font-bold truncate ${t(a,"text-gray-900","text-white")}`,children:o.name}),e.jsxs("p",{className:`text-xs sm:text-sm font-semibold ${t(a,"text-gray-800","text-gray-200")}`,children:[V(o.price)," por ",$?"año":"mes"]})]})]})}),!r&&e.jsx("div",{className:`rounded-xl sm:rounded-2xl p-4 border ${t(a,"bg-red-50 border-red-200","bg-red-900/20 border-red-600")}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-lg",children:"🔐"})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-semibold ${t(a,"text-red-900","text-red-200")}`,children:"Registro Requerido"}),e.jsx("p",{className:`text-xs ${t(a,"text-red-700","text-red-300")}`,children:"Debes iniciar sesión para realizar compras"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-3 ${t(a,"text-gray-900","text-white")}`,children:"Duración"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[1,2,3,6].map(m=>e.jsxs("button",{type:"button",onClick:()=>d(m),className:`px-3 py-2 sm:px-4 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-semibold transition-all duration-200 border-2 shadow-md ${c===m?"bg-blue-600 text-white border-blue-700 shadow-lg transform scale-105":t(a,"bg-gray-100 text-gray-800 border-gray-400 hover:bg-gray-200 hover:border-gray-600 hover:shadow-lg","bg-gray-700 text-gray-200 border-gray-500 hover:bg-gray-600 hover:border-gray-400 hover:shadow-lg")}`,children:[m," ",$?m===1?"año":"años":m===1?"mes":"meses"]},m))})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-3 ${t(a,"text-gray-900","text-white")}`,children:"Número de Dispositivos"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[e.jsx("button",{type:"button",onClick:()=>g>1&&b(g-1),disabled:g<=1,className:`w-9 h-9 sm:w-11 sm:h-11 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold transition-all border-2 shadow-md ${g<=1?t(a,"bg-gray-200 text-gray-400 cursor-not-allowed border-gray-300","bg-gray-600 text-gray-500 cursor-not-allowed border-gray-500"):t(a,"bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg","bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg")}`,children:"−"}),e.jsxs("div",{className:`border-2 rounded-xl px-4 sm:px-6 py-2 sm:py-3 min-w-[100px] sm:min-w-[120px] text-center shadow-lg ${t(a,"bg-blue-100 border-blue-700","bg-blue-900 border-blue-500")}`,children:[e.jsx("div",{className:`text-2xl sm:text-3xl font-bold ${t(a,"text-blue-900","text-blue-100")}`,children:g}),e.jsx("div",{className:`text-xs sm:text-sm font-bold ${t(a,"text-blue-800","text-blue-200")}`,children:g===1?"Dispositivo":"Dispositivos"})]}),e.jsx("button",{type:"button",onClick:()=>g<5&&b(g+1),disabled:g>=5,className:`w-9 h-9 sm:w-11 sm:h-11 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold transition-all border-2 shadow-md ${g>=5?t(a,"bg-gray-200 text-gray-400 cursor-not-allowed border-gray-300","bg-gray-600 text-gray-500 cursor-not-allowed border-gray-500"):t(a,"bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg","bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg")}`,children:"+"})]}),e.jsx("div",{className:`mt-2 text-xs ${t(a,"text-gray-600","text-gray-300")}`,children:"Máximo 5 dispositivos por compra"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold mb-3 sm:mb-4 text-sm sm:text-base ${t(a,"text-gray-800","text-gray-200")}`,children:"💳 Información de Pago"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-3 sm:p-4 text-white shadow-lg border-2 border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:"🏦"}),e.jsx("span",{className:"font-bold text-sm sm:text-base text-white",children:"Banco Pichincha"})]}),e.jsxs("div",{className:"text-xs sm:text-sm space-y-1 text-white",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Jeremias Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 2209034638"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorro Transaccional"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-700 to-purple-700 rounded-xl p-3 sm:p-4 text-white shadow-lg border-2 border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:"🏛️"}),e.jsx("span",{className:"font-bold text-sm sm:text-base text-white",children:"Banco Guayaquil"})]}),e.jsxs("div",{className:"text-xs sm:text-sm space-y-1 text-white",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Jeremias Joel Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 0122407273"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorros"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg p-3 sm:p-4 text-white shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-base sm:text-lg",children:"🌊"}),e.jsx("span",{className:"font-semibold text-xs sm:text-sm text-white",children:"Banco Pacífico"})]}),e.jsxs("div",{className:"text-xs space-y-1 text-purple-100",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Byron Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 1061220256"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorros"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-400 to-purple-500 rounded-lg p-3 sm:p-4 text-white shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-base sm:text-lg",children:"💳"}),e.jsx("span",{className:"font-semibold text-xs sm:text-sm text-white",children:"PayPal"})]}),e.jsxs("div",{className:"text-xs space-y-1 text-blue-100",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Email:"})," guale2023@outlook.com"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Método:"})," PayPal"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Transferencia"]})]})]})]}),e.jsx("div",{className:`mt-3 sm:mt-4 p-4 sm:p-6 rounded-2xl ${t(a,"bg-gradient-to-br from-orange-50 to-yellow-50 border-2 border-orange-200","bg-gradient-to-br from-orange-900/30 to-yellow-900/30 border-2 border-orange-500")}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3 sm:mb-4",children:e.jsx("div",{className:`p-3 sm:p-4 rounded-full ${t(a,"bg-orange-100","bg-orange-800/50")}`,children:e.jsx("span",{className:"text-3xl sm:text-4xl",children:"🚨"})})}),e.jsx("h5",{className:"text-lg sm:text-xl font-bold text-orange-800 dark:text-orange-200 mb-2 sm:mb-3",children:"⚠️ Instrucciones Importantes"}),e.jsxs("div",{className:`p-3 sm:p-4 rounded-xl ${t(a,"bg-white/80","bg-black/20")}`,children:[e.jsxs("p",{className:"text-xs sm:text-sm text-orange-700 dark:text-orange-300 mb-3 sm:mb-4",children:["Una vez que hayas realizado el pago, ",e.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"debes confirmar tu compra"})," enviando una captura del comprobante por WhatsApp a nuestros agentes."]}),e.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:`px-3 sm:px-4 py-2 rounded-lg ${t(a,"bg-green-100 text-green-800","bg-green-800/50 text-green-200")}`,children:[e.jsx("span",{className:"text-base sm:text-lg",children:"📱"}),e.jsx("span",{className:"ml-1 sm:ml-2 font-semibold text-xs sm:text-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:`px-3 sm:px-4 py-2 rounded-lg ${t(a,"bg-blue-100 text-blue-800","bg-blue-800/50 text-blue-200")}`,children:[e.jsx("span",{className:"text-base sm:text-lg",children:"💬"}),e.jsx("span",{className:"ml-1 sm:ml-2 font-semibold text-xs sm:text-sm",children:"Agentes"})]})]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 font-medium",children:"⚡ Sin el comprobante, tu servicio NO será activado"})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-2 ${t(a,"text-gray-900","text-white")}`,children:"Notas adicionales (opcional)"}),e.jsx("textarea",{value:v,onChange:m=>S(m.target.value),placeholder:"Comentarios o instrucciones especiales...",className:`w-full rounded-lg border-2 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm resize-none shadow-md ${t(a,"border-gray-400 bg-white text-gray-900 focus:border-blue-500","border-gray-500 bg-gray-700 text-gray-100 focus:border-blue-400")}`,rows:2})]}),e.jsx("div",{className:`bg-gradient-to-r border-2 rounded-xl p-4 sm:p-6 shadow-lg ${t(a,"from-blue-100 to-purple-100 border-blue-600","from-blue-900 to-purple-900 border-blue-500")}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`text-lg sm:text-xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Total a pagar:"}),e.jsx("span",{className:`text-2xl sm:text-3xl font-black ${t(a,"text-blue-800","text-blue-200")}`,children:V(_)})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 pt-2",children:[e.jsx("button",{onClick:n,className:`flex-1 rounded-lg sm:rounded-xl px-4 sm:px-6 py-3 sm:py-4 font-bold transition-all text-sm sm:text-base border-2 shadow-md ${t(a,"bg-gray-100 text-gray-800 hover:bg-gray-200 border-gray-400","bg-gray-700 text-gray-200 hover:bg-gray-600 border-gray-500")}`,children:"Cancelar"}),e.jsx("button",{onClick:P,disabled:!r,className:`flex-1 rounded-lg sm:rounded-xl px-4 sm:px-6 py-3 sm:py-4 font-bold transition-all shadow-lg text-sm sm:text-base border-2 transform ${r?"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-xl border-blue-700 hover:scale-105":"bg-gray-400 text-gray-600 cursor-not-allowed border-gray-500"}`,children:r?"🛒 Completar Compra":"🔐 Registro Requerido"})]})]})]})})}function Se({open:s,onClose:n,onRegister:o,isDark:r,systemPrefersDark:a}){const[i,l]=N.useState({name:"",phone:"",countryCode:"+593",email:"",service:"",price:"",duration:1,isAnnual:!1,startDate:new Date().toISOString().slice(0,10),service_email:"",service_password:"",admin_notes:""});if(N.useEffect(()=>{if(i.service){const d=U.find(b=>b.name===i.service);if(d){const b=d.price*i.duration;l(v=>({...v,price:b.toString()}));return}const g=B.find(b=>b.name===i.service);if(g){const b=g.price*i.duration;l(v=>({...v,price:b.toString()}))}}},[i.service,i.duration]),!s)return null;const p=d=>{if(d.preventDefault(),!i.name||!i.phone||!i.service||!i.service_email||!i.service_password){alert("⚠️ Por favor completa todos los campos requeridos, incluyendo las credenciales del servicio");return}const g=k(i.phone,i.countryCode),b=new Date(i.startDate),v=i.isAnnual?i.duration*12:i.duration;b.setDate(b.getDate()+v*30),o({...i,phone:g,price:parseFloat(i.price),endDate:b.toISOString().slice(0,10),months:v}),l({name:"",phone:"",countryCode:"+593",email:"",service:"",price:"",duration:1,isAnnual:!1,startDate:new Date().toISOString().slice(0,10),service_email:"",service_password:"",admin_notes:""}),n()},c=()=>{if(!i.phone||!i.service_email||!i.service_password){alert("⚠️ Por favor completa todos los campos requeridos antes de enviar por WhatsApp");return}const d=new Date(i.startDate),g=i.isAnnual?i.duration*12:i.duration;d.setMonth(d.getMonth()+g);const b=d.toISOString().slice(0,10),v=`🎉 ¡Hola ${i.name}! 🎉

✨ Aquí tienes tus credenciales de ${i.service}:

🔑 *CREDENCIALES DEL SERVICIO* 🔑
📧 *Email:* ${i.service_email}
🔐 *Contraseña:* ${i.service_password}

⏰ *Duración:* ${g} ${g===1?"mes":"meses"}
📅 *Válido hasta:* ${b}

🎬 ¡Disfruta tu servicio! 🎬

💬 Si tienes alguna pregunta, no dudes en contactarnos.

🙏 ¡Gracias por confiar en nosotros!`,$=`https://wa.me/${M(i.phone)}?text=${encodeURIComponent(v)}`;window.open($,"_blank")};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:n,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${t(r,"bg-white","bg-gray-900")}`,onClick:d=>d.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${t(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Registrar Compra Manual"}),e.jsx("button",{onClick:n,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${t(r,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"×"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200","bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border-blue-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(r,"bg-blue-100","bg-blue-900/30")}`,children:"👤"}),e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Información del Cliente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"👤 Nombre del Cliente *"}),e.jsx("input",{type:"text",value:i.name,onChange:d=>l({...i,name:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"Nombre completo del cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"📱 Teléfono *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:i.countryCode,onChange:d=>l({...i,countryCode:d.target.value}),className:`w-28 sm:w-32 rounded-xl border-2 px-2 sm:px-3 py-3 text-xs sm:text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,children:ge.map(d=>e.jsxs("option",{value:d.code,children:[d.flag," ",d.code]},d.code))}),e.jsx("input",{type:"tel",value:i.phone,onChange:d=>l({...i,phone:d.target.value}),className:`flex-1 min-w-0 rounded-xl border-2 px-3 sm:px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"99 999 9999",required:!0})]}),e.jsxs("div",{className:`text-xs ${t(r,"text-gray-500","text-gray-400")}`,children:["Número completo: ",i.countryCode," ",i.phone]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200","bg-gradient-to-br from-green-900/20 to-emerald-900/20 border-green-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(r,"bg-green-100","bg-green-900/30")}`,children:"🎬"}),e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Servicio y Duración"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"🎬 Servicio *"}),e.jsxs("select",{value:i.service,onChange:d=>l({...i,service:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")}`,required:!0,children:[e.jsx("option",{value:"",children:"Selecciona un servicio"}),e.jsx("optgroup",{label:"🎬 Servicios Individuales",children:U.map(d=>e.jsxs("option",{value:d.name,children:[d.name," - $",d.price,"/mes"]},d.name))}),e.jsx("optgroup",{label:"🎁 Combos Especiales",children:B.map(d=>e.jsxs("option",{value:d.name,children:[d.name," - $",d.price,"/mes"]},d.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"⏱️ Duración (meses) *"}),e.jsxs("select",{value:i.duration,onChange:d=>l({...i,duration:Number(d.target.value)}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")}`,required:!0,children:[e.jsx("option",{value:1,children:"1 mes"}),e.jsx("option",{value:3,children:"3 meses"}),e.jsx("option",{value:6,children:"6 meses"}),e.jsx("option",{value:12,children:"12 meses"})]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"💰 Precio Total"}),e.jsxs("div",{className:`p-3 rounded-lg ${t(r,"bg-green-100 border border-green-200","bg-green-900/20 border border-green-600")}`,children:[e.jsxs("p",{className:`text-lg font-bold ${t(r,"text-green-800","text-green-300")}`,children:["$",i.price||"0.00"," USD"]}),e.jsxs("p",{className:`text-sm ${t(r,"text-green-700","text-green-400")}`,children:[i.duration," ",i.duration===1?"mes":"meses"," de ",i.service||"servicio"]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200","bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(r,"bg-yellow-100","bg-yellow-900/30")}`,children:"🔑"}),e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"📧 Email del servicio *"}),e.jsx("input",{type:"email",value:i.service_email,onChange:d=>l({...i,service_email:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,placeholder:"usuario@servicio.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"🔐 Contraseña del servicio *"}),e.jsx("input",{type:"text",value:i.service_password,onChange:d=>l({...i,service_password:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,placeholder:"••••••••",required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200","bg-gradient-to-br from-amber-900/20 to-orange-900/20 border-amber-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(r,"bg-amber-100","bg-amber-900/30")}`,children:"📝"}),e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Notas del Administrador"})]}),e.jsx("textarea",{value:i.admin_notes,onChange:d=>l({...i,admin_notes:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-amber-500 focus:ring-amber-200","border-gray-600 bg-gray-700 text-white focus:border-amber-400 focus:ring-amber-800/30")}`,rows:4,placeholder:"Escribe información importante para el cliente (puedes usar saltos de línea)..."}),e.jsx("div",{className:`mt-3 p-3 rounded-lg ${t(r,"bg-amber-100 border border-amber-200","bg-amber-900/20 border border-amber-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${t(r,"text-amber-800","text-amber-300")}`,children:["💡 ",e.jsx("strong",{children:"Nota:"})," Esta información será visible para el cliente y puede incluir instrucciones especiales, detalles de renovación, o cualquier información relevante."]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:n,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 ${t(r,"bg-gray-200 text-gray-800 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"❌"}),e.jsx("span",{children:"Cancelar"})]})}),e.jsxs("button",{type:"button",onClick:c,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 ${t(r,"bg-green-500 text-white hover:bg-green-600 shadow-lg hover:shadow-xl","bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-xl")}`,children:[e.jsx("span",{className:"text-lg",children:"📱"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsxs("button",{type:"submit",className:"w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl",children:[e.jsx("span",{className:"text-lg",children:"💾"}),e.jsx("span",{className:"truncate",children:"Registrar Compra"})]})]})]})})]})})}function $e({open:s,onClose:n,onUpdate:o,purchase:r,isDark:a,systemPrefersDark:i}){const l=r?.service||"",p=l.includes("+")||l.includes("Netflix")&&l.includes("Disney");let c=[l];p&&(l.includes("Netflix")&&l.includes("Disney")?c=["Netflix",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Max")&&l.includes("Prime")?c=["Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")?c=["Netflix","Max"]:l.includes("Netflix")&&l.includes("Prime")?c=["Netflix","Prime Video"]:l.includes("Prime")&&l.includes("Disney")?c=["Prime Video",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Disney")&&l.includes("Max")?c=[l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar","Max"]:l.includes("Spotify")&&l.includes("Netflix")?c=["Spotify","Netflix"]:l.includes("Spotify")&&l.includes("Disney")?c=["Spotify",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Spotify")&&l.includes("Prime")?c=["Spotify","Prime Video"]:l.includes("Paramount")&&l.includes("Max")&&l.includes("Prime")?c=["Paramount+","Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")&&l.includes("Disney")?c=["Netflix","Max",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar","Prime Video","Paramount+"]:c=l.split(/\s*\+\s*/).map(u=>u.trim()).filter(u=>u.length>0));const[d,g]=N.useState({customer:"",phone:"",service:"",start:"",end:"",months:1,service_email:"",service_password:"",admin_notes:""}),[b,v]=N.useState(!1),[S,$]=N.useState({}),_=(u,y)=>{if(!u)return"";const w=new Date(u),f=new Date(w);return f.setDate(f.getDate()+y*30),f.toISOString().split("T")[0]},P=u=>{g(y=>({...y,start:u,end:_(u,y.months)}))},m=u=>{g(y=>({...y,months:u,end:_(y.start,u)}))};if(N.useEffect(()=>{if(r&&(g({customer:r.customer||"",phone:r.phone||"",service:r.service||"",start:r.start||"",end:r.end||"",months:r.months||1,service_email:r.service_email||"",service_password:r.service_password||"",admin_notes:r.admin_notes||""}),p&&r.service_password)){const u={};r.service_password.split(`

`).forEach(w=>{const f=w.split(`
`);if(f.length>=3){const C=f[0].replace(":","").trim(),O=f[1].replace("Email: ","").trim(),R=f[2].replace("Contraseña: ","").trim();C&&O&&R&&(u[C]={email:O,password:R})}}),$(u),console.log("📋 Credenciales parseadas:",u)}},[r,p]),!s||!r)return null;const h=u=>{u.preventDefault();let y={...d};if(p){const w=c.map(f=>{const C=S[f];return C?.email&&C?.password?`${f}:
Email: ${C.email}
Contraseña: ${C.password}`:""}).filter(f=>f.length>0).join(`

`);y.service_email=`COMBO: ${c.join(" + ")}`,y.service_password=w}o(y),n()},j=()=>{const u=`🎉 ¡Hola ${d.customer}! 🎉

✨ Aquí tienes tus credenciales de ${d.service}:

🔑 *CREDENCIALES DEL SERVICIO* 🔑
📧 *Email:* ${d.service_email}
🔐 *Contraseña:* ${d.service_password}

⏰ *Duración:* ${d.months} ${d.months===1?"mes":"meses"}
📅 *Válido hasta:* ${d.end}

🎬 ¡Disfruta tu servicio! 🎬

💬 Si tienes alguna pregunta, no dudes en contactarnos.

🙏 ¡Gracias por confiar en nosotros!`,w=`https://wa.me/${M(d.phone)}?text=${encodeURIComponent(u)}`;window.open(w,"_blank")};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:n,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${t(a,"bg-white","bg-gray-900")}`,onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${t(a,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Editar Compra"}),e.jsx("button",{onClick:n,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${t(a,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"×"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(a,"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200","bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border-blue-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(a,"bg-blue-100","bg-blue-900/30")}`,children:"👤"}),e.jsx("h4",{className:`text-xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Información del Cliente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"👤 Nombre del Cliente *"}),e.jsx("input",{type:"text",value:d.customer,onChange:u=>g({...d,customer:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"Nombre completo del cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"📱 Teléfono *"}),e.jsx("input",{type:"tel",value:d.phone,onChange:u=>g({...d,phone:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"+593 99 999 9999",required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(a,"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200","bg-gradient-to-br from-green-900/20 to-emerald-900/20 border-green-700")}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(a,"bg-green-100","bg-green-900/30")}`,children:"📅"}),e.jsx("h4",{className:`text-xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Fechas y Duración"})]}),e.jsx("button",{type:"button",onClick:()=>v(!b),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${t(a,"bg-green-100 text-green-800 hover:bg-green-200","bg-green-900/30 text-green-200 hover:bg-green-800/40")}`,children:b?"🔒 Bloquear":"✏️ Editar Fechas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"📅 Fecha de Inicio *"}),e.jsx("input",{type:"date",value:d.start,onChange:u=>P(u.target.value),disabled:!b,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${b?"":"opacity-60 cursor-not-allowed"}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"⏱️ Duración (meses) *"}),e.jsxs("select",{value:d.months,onChange:u=>m(Number(u.target.value)),disabled:!b,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${b?"":"opacity-60 cursor-not-allowed"}`,required:!0,children:[e.jsx("option",{value:1,children:"1 mes"}),e.jsx("option",{value:3,children:"3 meses"}),e.jsx("option",{value:6,children:"6 meses"}),e.jsx("option",{value:12,children:"12 meses"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"🏁 Fecha de Fin"}),e.jsx("input",{type:"date",value:d.end,onChange:u=>g({...d,end:u.target.value}),disabled:!b,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${b?"":"opacity-60 cursor-not-allowed"}`})]})]}),b&&e.jsx("div",{className:`mt-4 p-3 rounded-lg ${t(a,"bg-green-100 border border-green-200","bg-green-900/20 border border-green-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${t(a,"text-green-800","text-green-300")}`,children:["💡 ",e.jsx("strong",{children:"Tip:"})," La fecha de fin se calcula automáticamente basada en la fecha de inicio y duración. Útil para renovaciones o ajustes de fechas."]})})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(a,"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200","bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(a,"bg-yellow-100","bg-yellow-900/30")}`,children:"🔑"}),e.jsx("h4",{className:`text-xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${t(a,"bg-orange-50 border border-orange-200","bg-orange-900/20 border border-orange-600")}`,children:e.jsx("p",{className:`text-sm font-semibold ${t(a,"text-orange-800","text-orange-300")}`,children:"🎁 Combo detectado: Edita las credenciales para cada servicio"})}),c.map((u,y)=>e.jsxs("div",{className:`p-4 rounded-lg border ${t(a,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-600")}`,children:[e.jsxs("h5",{className:`text-lg font-bold mb-3 ${t(a,"text-gray-800","text-white")}`,children:[u," ",y===0?"🎬":y===1?"🎭":y===2?"🎪":"🎯"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${t(a,"text-gray-700","text-gray-300")}`,children:["📧 Email del ",u]}),e.jsx("input",{type:"email",value:S[u]?.email||"",onChange:w=>$(f=>({...f,[u]:{...f[u],email:w.target.value,password:f[u]?.password||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500/20 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-blue-500","border-gray-600 bg-gray-700 text-white focus:border-blue-400")}`,placeholder:`usuario@${u.toLowerCase().replace(/[^a-z]/g,"")}.com`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${t(a,"text-gray-700","text-gray-300")}`,children:["🔑 Contraseña del ",u]}),e.jsx("input",{type:"password",value:S[u]?.password||"",onChange:w=>$(f=>({...f,[u]:{...f[u],password:w.target.value,email:f[u]?.email||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-amber-500/20 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-amber-500","border-gray-600 bg-gray-700 text-white focus:border-amber-400")}`,placeholder:"••••••••"})]})]})]},u))]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"Email del servicio *"}),e.jsx("input",{type:"email",value:d.service_email,onChange:u=>g({...d,service_email:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(a,"text-gray-700","text-gray-300")}`,children:"Contraseña del servicio *"}),e.jsx("input",{type:"text",value:d.service_password,onChange:u=>g({...d,service_password:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(a,"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200","bg-gradient-to-br from-amber-900/20 to-orange-900/20 border-amber-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(a,"bg-amber-100","bg-amber-900/30")}`,children:"📝"}),e.jsx("h4",{className:`text-xl font-bold ${t(a,"text-gray-900","text-white")}`,children:"Notas del Administrador"})]}),e.jsx("textarea",{value:d.admin_notes,onChange:u=>g({...d,admin_notes:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${t(a,"border-gray-300 bg-white text-gray-900 focus:border-amber-500 focus:ring-amber-200","border-gray-600 bg-gray-700 text-white focus:border-amber-400 focus:ring-amber-800/30")}`,rows:4,placeholder:"Escribe información importante para el cliente (puedes usar saltos de línea)..."}),e.jsx("div",{className:`mt-3 p-3 rounded-lg ${t(a,"bg-amber-100 border border-amber-200","bg-amber-900/20 border border-amber-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${t(a,"text-amber-800","text-amber-300")}`,children:["💡 ",e.jsx("strong",{children:"Nota:"})," Esta información será visible para el cliente y puede incluir instrucciones especiales, detalles de renovación, o cualquier información relevante."]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:n,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 ${t(a,"bg-gray-200 text-gray-800 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"❌"}),e.jsx("span",{children:"Cancelar"})]})}),e.jsxs("button",{type:"button",onClick:j,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 ${t(a,"bg-green-500 text-white hover:bg-green-600 shadow-lg hover:shadow-xl","bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-xl")}`,children:[e.jsx("span",{className:"text-lg",children:"📱"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsxs("button",{type:"submit",className:"w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl",children:[e.jsx("span",{className:"text-lg",children:"💾"}),e.jsx("span",{className:"truncate",children:"Guardar Cambios"})]})]})]})})]})})}function L(s,n,o){return s?o:n}function Ce({open:s,onClose:n,children:o,title:r,isDark:a,className:i}){return s?e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/50 p-4",onClick:n,children:e.jsxs("div",{className:`w-full max-w-lg rounded-2xl p-6 shadow-2xl ${L(a,"bg-white","bg-zinc-900")} ${i||""}`,onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold",children:r}),e.jsx("button",{onClick:n,className:`w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold transition-colors ${L(a,"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-100","text-zinc-300 hover:text-zinc-100 hover:bg-zinc-800")}`,children:"×"})]}),o]})}):null}function _e({isOpen:s,onClose:n,purchase:o,isDark:r,onApprove:a,onUpdatePurchase:i}){const l=o?.service||"";console.log("🔍 DEBUGGING - Servicio completo:",l);const p=l.includes("+")||l.includes("Netflix")&&l.includes("Disney");console.log("🔍 DEBUGGING - Es combo?:",p);let c=[l];p&&(l.includes("Netflix")&&l.includes("Disney")?c=["Netflix",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Max")&&l.includes("Prime")?c=["Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")?c=["Netflix","Max"]:l.includes("Netflix")&&l.includes("Prime")?c=["Netflix","Prime Video"]:l.includes("Prime")&&l.includes("Disney")?c=["Prime Video",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Disney")&&l.includes("Max")?c=[l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar","Max"]:l.includes("Spotify")&&l.includes("Netflix")?c=["Spotify","Netflix"]:l.includes("Spotify")&&l.includes("Disney")?c=["Spotify",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar"]:l.includes("Spotify")&&l.includes("Prime")?c=["Spotify","Prime Video"]:l.includes("Paramount")&&l.includes("Max")&&l.includes("Prime")?c=["Paramount+","Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")&&l.includes("Disney")?c=["Netflix","Max",l.includes("Premium")?"Disney+ Premium":"Disney+ Estándar","Prime Video","Paramount+"]:c=l.split(/\s*\+\s*/).map(m=>m.trim()).filter(m=>m.length>0),console.log("🎯 COMBO DETECTADO - Servicios separados:",c)),console.log("🎯 FINAL - isCombo:",p,"services:",c);const[d,g]=N.useState({email:"",password:"",notes:""}),[b,v]=N.useState({}),[S,$]=N.useState(!1);if(!s||!o)return null;const _=()=>{const m=`🎬✨ *StreamZone* ✨🎬
🌟 *¡COMPRA APROBADA!* 🌟

👋 ¡Hola ${o.customer}! 👋

🎉✨ ¡FELICIDADES! ✨🎉
Tu compra de *${o.service}* ha sido aprobada exitosamente 🎊

🎯 *Detalles de tu compra:*
📱 Servicio: *${o.service}*
📅 Duración: *${o.months} meses*
💰 Estado: *ACTIVO* ✅

💻 Puedes ver todos los detalles en nuestra página web 💻

🎁 *Beneficios que obtienes:*
✅ Acceso inmediato al servicio
✅ Soporte técnico 24/7
✅ Actualizaciones automáticas
✅ Calidad premium garantizada

🌟 *¡Tu recomendación nos ayuda a crecer!* 🌟
💝 ¡Muchas gracias por confiar en StreamZone! 💝

🎬✨ *¡Disfruta tu entretenimiento!* ✨🎬`,j=`https://wa.me/${M(o.phone)}?text=${encodeURIComponent(m)}`;window.open(j,"_blank")},P=async()=>{if(console.log("🚀 ===== INICIANDO APROBACIÓN DE COMPRA ====="),console.log("📋 purchase:",o),console.log("📋 isCombo:",p),console.log("📋 services:",c),console.log("📋 serviceCredentials:",d),console.log("📋 multiCredentials:",b),console.log("📋 onApprove function:",a),console.log("📋 onUpdatePurchase function:",i),p){if(c.some(h=>!b[h]?.email||!b[h]?.password)){alert("Por favor completa el email y contraseña para todos los servicios del combo");return}}else if(!d.email||!d.password){alert("Por favor completa el email y contraseña del servicio");return}$(!0);try{let m,h,j;if(p){const y=c.map(w=>{const f=b[w];return`${w}:
Email: ${f.email}
Contraseña: ${f.password}`}).join(`

`);m=`COMBO: ${c.join(" + ")}`,h=y,j=d.notes}else m=d.email,h=d.password,j=d.notes;console.log("🔄 Modal: Iniciando aprobación...",{purchaseId:o.id,isCombo:p,emailToSave:m,passwordToSave:h?"***":"undefined",notesToSave:j});const u=await J(o.id,m,h,j,"admin");if(console.log("📋 Modal: Resultado de approvePurchase:",u),u.data)console.log("✅ Modal: Compra aprobada en Supabase, actualizando estado local..."),i&&i(o.id,{validated:!0,service_email:m,service_password:h,admin_notes:j}),console.log("✅ Compra guardada en la base de datos exitosamente"),console.log("🔄 Actualizando estado local inmediatamente..."),i&&i(o.id,{validated:!0,service_email:m,service_password:h,admin_notes:j}),console.log("🔄 Llamando a onApprove para recargar datos..."),await a(),setTimeout(()=>{console.log("🔄 Cerrando modal después de actualización..."),n(),g({email:"",password:"",notes:""}),v({})},500),alert("✅ Compra aprobada y actualizada correctamente");else throw new Error("No se pudo guardar en la base de datos")}catch(m){console.error("Error aprobando compra:",m),alert("❌ Error al guardar en la base de datos")}finally{$(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:n,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${t(r,"bg-white","bg-gray-900")}`,onClick:m=>m.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${t(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Aprobar Compra"}),e.jsx("button",{onClick:n,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${t(r,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"×"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{className:"space-y-6",children:[e.jsx("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:o.customer}),e.jsxs("p",{className:`text-lg font-semibold ${t(r,"text-gray-700","text-gray-300")}`,children:[o.service," • ",o.months," ",o.months===1?"mes":"meses"]})]}),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${t(r,"bg-blue-100","bg-blue-900/30")}`,children:[e.jsx("span",{className:"text-lg",children:"📱"}),e.jsx("span",{className:`font-semibold ${t(r,"text-blue-800","text-blue-200")}`,children:o.phone})]})]})}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-purple-50 border-purple-200","bg-purple-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${t(r,"bg-yellow-100","bg-yellow-900/30")}`,children:"🔑"}),e.jsx("h4",{className:`text-xl font-bold ${t(r,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${t(r,"bg-orange-50 border border-orange-200","bg-orange-900/20 border border-orange-600")}`,children:e.jsx("p",{className:`text-sm font-semibold ${t(r,"text-orange-800","text-orange-300")}`,children:"🎁 Combo detectado: Ingresa las credenciales para cada servicio"})}),c.map((m,h)=>e.jsxs("div",{className:`p-4 rounded-lg border ${t(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-600")}`,children:[e.jsxs("h5",{className:`text-lg font-bold mb-3 ${t(r,"text-gray-800","text-white")}`,children:[m," ",h===0?"🎬":h===1?"🎭":h===2?"🎪":"🎯"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${t(r,"text-gray-700","text-gray-300")}`,children:["📧 Email del ",m]}),e.jsx("input",{type:"email",value:b[m]?.email||"",onChange:j=>v(u=>({...u,[m]:{...u[m],email:j.target.value,password:u[m]?.password||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500/20 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500","border-gray-600 bg-gray-700 text-white focus:border-blue-400")}`,placeholder:`usuario@${m.toLowerCase().replace(/[^a-z]/g,"")}.com`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${t(r,"text-gray-700","text-gray-300")}`,children:["🔑 Contraseña del ",m]}),e.jsx("input",{type:"password",value:b[m]?.password||"",onChange:j=>v(u=>({...u,[m]:{...u[m],password:j.target.value,email:u[m]?.email||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-amber-500/20 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-amber-500","border-gray-600 bg-gray-700 text-white focus:border-amber-400")}`,placeholder:"••••••••"})]})]})]},m))]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"Email del servicio *"}),e.jsx("input",{type:"email",value:d.email,onChange:m=>g(h=>({...h,email:m.target.value})),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${t(r,"text-gray-700","text-gray-300")}`,children:"Contraseña del servicio *"}),e.jsx("input",{type:"text",value:d.password,onChange:m=>g(h=>({...h,password:m.target.value})),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${t(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:[e.jsx("h4",{className:`text-lg font-bold mb-4 ${t(r,"text-gray-900","text-white")}`,children:"Información Importante"}),e.jsx("textarea",{value:d.notes,onChange:m=>g(h=>({...h,notes:m.target.value})),placeholder:"Notas adicionales sobre esta compra...",className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${t(r,"border-gray-300 bg-white text-gray-900 focus:border-gray-500 focus:ring-gray-200","border-gray-600 bg-gray-700 text-white focus:border-gray-400 focus:ring-gray-800/30")}`,rows:3})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[e.jsx("button",{onClick:n,className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 ${t(r,"bg-gray-200 text-gray-700 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:"Cancelar"}),e.jsxs("button",{onClick:_,disabled:p?c.some(m=>!b[m]?.email||!b[m]?.password):!d.email||!d.password,className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${t(r,"bg-green-500 text-white hover:bg-green-600","bg-green-600 text-white hover:bg-green-700")}`,children:[e.jsx("span",{className:"text-lg",children:"📱"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),console.log("🚀 BOTÓN APROBAR CLICKEADO"),console.log("🔍 loading:",S),console.log("🔍 serviceCredentials:",d),P()},disabled:S||(p?c.some(m=>!b[m]?.email||!b[m]?.password):!d.email||!d.password),className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 ${t(r,"bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl","bg-gradient-to-r from-blue-600 to-purple-700 text-white hover:from-blue-700 hover:to-purple-800 shadow-lg hover:shadow-xl")}`,children:S?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"truncate",children:"Aprobando..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsx("span",{className:"truncate",children:"Aprobar Compra"})]})})]})]})})]})})}export{ue as A,Se as B,ge as C,we as D,$e as E,_e as F,se as G,B as H,je as I,Ce as M,Ne as P,pe as R,U as S,k as a,re as b,F as c,fe as d,ee as e,V as f,X as g,te as h,ne as i,e as j,de as k,me as l,ie as m,le as n,ae as o,he as p,M as q,N as r,x as s,t,oe as u,Q as v,ve as w,ye as x,ce as y,Z as z};

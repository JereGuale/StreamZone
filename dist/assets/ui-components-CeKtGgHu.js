import{r as Y,a as oe}from"./react-vendor-Y7T1HomI.js";import{c as se}from"./supabase-L-NHoLOp.js";var V={exports:{}},O={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W;function ae(){if(W)return O;W=1;var o=Y(),t=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(x,b,u){var f,j={},h=null,p=null;u!==void 0&&(h=""+u),b.key!==void 0&&(h=""+b.key),b.ref!==void 0&&(p=b.ref);for(f in b)r.call(b,f)&&!i.hasOwnProperty(f)&&(j[f]=b[f]);if(x&&x.defaultProps)for(f in b=x.defaultProps,b)j[f]===void 0&&(j[f]=b[f]);return{$$typeof:t,type:x,key:h,ref:p,props:j,_owner:n.current}}return O.Fragment=a,O.jsx=l,O.jsxs=l,O}var F;function ne(){return F||(F=1,V.exports=ae()),V.exports}var e=ne(),P=Y();const le=oe(P),J=o=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"USD"}).format(o),qe={load(o,t){try{return JSON.parse(localStorage.getItem(o)||JSON.stringify(t))}catch{return t}},save(o,t){localStorage.setItem(o,JSON.stringify(t))},del(o){localStorage.removeItem(o)}};function Ge(o,t){const a=new Date(o),n=new Date(t).getTime()-a.getTime();return Math.floor(n/(1e3*60*60*24))}function s(o,t,a){return o?a:t}const ie=o=>{const t=new Date,r=new Date(o).getTime()-t.getTime();return Math.round(r/(1e3*60*60*24))},Be=(o,t)=>{const a=new Date(o);a.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const n=r.getTime()-a.getTime();return Math.ceil(n/(1e3*60*60*24))},Le=o=>{const t=ie(o);return t<0?{status:"expired",color:"text-red-600",icon:"âŒ",message:"Servicio Caducado"}:t===0?{status:"expires-today",color:"text-red-600",icon:"âš ï¸",message:"Caduca Hoy"}:{status:"active",color:"text-red-600",icon:"â°",message:`${t} ${t===1?"dÃ­a":"dÃ­as"} restantes`}};function K(o){return o.replace(/[^\d]/g,"")}function de(o,t="+593"){const a=K(o);return a.length===0?"":a.startsWith("593")&&a.length>=9?`+${a}`:a.length===9?`${t}${a}`:a.length===12&&a.startsWith("593")?`+${a}`:a}function B(o,t="593"){const a=K(o);return a.length===0?"":a.startsWith("593")&&a.length>=9?a:a.length===9?`${t}${a}`:a}function Ue(o){return{netflix:"Series originales, thrillers, documentales",disney:"Marvel, Star Wars, Pixar, familias",max:"HBO premium, series Ã©picas, pelÃ­culas",prime:"Exclusivas, blockbusters, Amazon",spotify:"MÃºsica, podcasts, audiolibros",paramount:"Paramount, Nickelodeon, MTV",apple:"Originales Apple, 4K premium"}[o]||"Contenido premium de entretenimiento"}const q=[{id:"netflix",name:"Netflix",price:4,billing:"monthly",color:"bg-red-600",logo:"N"},{id:"disney_premium",name:"Disney+ Premium",price:3.75,billing:"monthly",color:"bg-blue-600",logo:"D+"},{id:"disney_standard",name:"Disney+ Standard",price:3.25,billing:"monthly",color:"bg-blue-500",logo:"D+"},{id:"max",name:"Max",price:3,billing:"monthly",color:"bg-purple-700",logo:"MAX"},{id:"vix",name:"ViX",price:2.5,billing:"monthly",color:"bg-orange-500",logo:"ViX"},{id:"prime",name:"Prime Video",price:3,billing:"monthly",color:"bg-sky-700",logo:"PV"},{id:"youtube_premium",name:"YouTube Premium",price:3.35,billing:"monthly",color:"bg-red-700",logo:"YT"},{id:"paramount",name:"Paramount+",price:2.75,billing:"monthly",color:"bg-indigo-600",logo:"P+"},{id:"chatgpt",name:"ChatGPT",price:4,billing:"monthly",color:"bg-zinc-800",logo:"GPT"},{id:"crunchy",name:"Crunchyroll",price:2.5,billing:"monthly",color:"bg-orange-600",logo:"CR"},{id:"spotify",name:"Spotify",price:3.5,billing:"monthly",color:"bg-emerald-600",logo:"SP"},{id:"deezer",name:"Deezer",price:3,billing:"monthly",color:"bg-blue-700",logo:"DZ"},{id:"apple_tv",name:"Apple TV+",price:3.5,billing:"monthly",color:"bg-neutral-900",logo:"ATV"},{id:"canva_pro",name:"Canva Pro",price:2,billing:"monthly",color:"bg-indigo-500",logo:"C"},{id:"canva_pro_annual",name:"Canva Pro (1 aÃ±o)",price:17.5,billing:"annual",color:"bg-indigo-600",logo:"C"},{id:"microsoft365",name:"Microsoft 365 (1 aÃ±o)",price:15,billing:"annual",color:"bg-blue-500",logo:"M365"},{id:"autodesk",name:"Autodesk (1 aÃ±o)",price:12.5,billing:"annual",color:"bg-zinc-700",logo:"AD"},{id:"office365",name:"Office 365 (1 aÃ±o)",price:15,billing:"annual",color:"bg-blue-600",logo:"O365"}],G=[{id:"netflix_disney_std",name:"Netflix + Disney EstÃ¡ndar",price:6,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-500",logo:"N+D"},{id:"netflix_disney_premium",name:"Netflix + Disney Premium",price:6.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-600",logo:"N+D+"},{id:"netflix_max",name:"Netflix + Max",price:5.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-purple-700",logo:"N+MAX"},{id:"netflix_prime",name:"Netflix + Prime Video",price:5.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-sky-700",logo:"N+PV"},{id:"prime_disney_std",name:"Prime Video + Disney EstÃ¡ndar",price:5.75,billing:"monthly",color:"bg-gradient-to-r from-sky-700 to-blue-500",logo:"PV+D"},{id:"disney_premium_max",name:"Disney Premium + Max",price:6,billing:"monthly",color:"bg-gradient-to-r from-blue-600 to-purple-700",logo:"D++MAX"},{id:"max_prime",name:"Max + Prime Video",price:5.5,billing:"monthly",color:"bg-gradient-to-r from-purple-700 to-sky-700",logo:"MAX+PV"},{id:"paramount_max_prime",name:"Paramount + Max + Prime Video",price:7,billing:"monthly",color:"bg-gradient-to-r from-indigo-600 via-purple-700 to-sky-700",logo:"P+MAX+PV"},{id:"mega_combo",name:"Netflix + Max + Disney + Prime + Paramount",price:11.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-purple-700 via-blue-500 via-sky-700 to-indigo-600",logo:"MEGA"},{id:"spotify_netflix",name:"Spotify + Netflix",price:6.5,billing:"monthly",color:"bg-gradient-to-r from-emerald-600 to-red-600",logo:"SP+N"},{id:"spotify_disney_premium",name:"Spotify + Disney Premium",price:6.5,billing:"monthly",color:"bg-gradient-to-r from-emerald-600 to-blue-600",logo:"SP+D+"},{id:"spotify_prime",name:"Spotify + Prime Video",price:6,billing:"monthly",color:"bg-gradient-to-r from-emerald-600 to-sky-700",logo:"SP+PV"},{id:"netflix_spotify_disney_std",name:"Netflix + Spotify + Disney Standar",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-blue-500",logo:"N+SP+D"},{id:"netflix_spotify_prime",name:"Netflix + Spotify + Prime Video",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-sky-700",logo:"N+SP+PV"}],ce={netflix:"/logos/netflix.png",disney_premium:"/logos/disney_premium.png",disney_standard:"/logos/disney_standard.jpeg",max:"/logos/max.jpeg",spotify:"/logos/spotify.jpeg",chatgpt:"/logos/chatgpt.png",deezer:"/logos/deezer.png",crunchy:"/logos/crunchyroll.png",paramount:"/logos/paramount.png",youtube_premium:"/logos/youtube_premium.png",office365:"/logos/office365.jpeg",microsoft365:"/logos/office365.jpeg"};function me({size:o=48,className:t=""}){return e.jsxs("svg",{viewBox:"0 0 48 48",width:o,height:o,className:t,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"vix-grad",x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#f97316"}),e.jsx("stop",{offset:"100%",stopColor:"#ea580c"})]})}),e.jsx("rect",{width:"48",height:"48",rx:"10",fill:"url(#vix-grad)"}),e.jsx("text",{x:"24",y:"31",fontFamily:"Arial,sans-serif",fontSize:"16",fontWeight:"800",fill:"#fff",textAnchor:"middle",children:"ViX"})]})}function ue({size:o=48,className:t=""}){return e.jsxs("svg",{viewBox:"0 0 48 48",width:o,height:o,className:t,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"prime-grad",x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#00a8e1"}),e.jsx("stop",{offset:"100%",stopColor:"#1a73e8"})]})}),e.jsx("rect",{width:"48",height:"48",rx:"10",fill:"#232f3e"}),e.jsx("text",{x:"24",y:"28",fontFamily:"Arial,sans-serif",fontSize:"11",fontWeight:"700",fill:"#fff",textAnchor:"middle",children:"prime"}),e.jsx("path",{d:"M12 34 C20 30, 28 30, 36 34",stroke:"url(#prime-grad)",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M33 32 l3 2 l1 -4",stroke:"url(#prime-grad)",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})}function ge({size:o=48,className:t=""}){return e.jsxs("svg",{viewBox:"0 0 48 48",width:o,height:o,className:t,children:[e.jsx("rect",{width:"48",height:"48",rx:"10",fill:"#1c1c1e"}),e.jsx("path",{d:"M24 12c1-3 4-4.5 4-4.5s.2 2.2-1 3.8c-1.3 1.7-2.7 1.4-2.7 1.4s-.3-1.3.7-2.7z",fill:"#a8a8a8",transform:"translate(-2,2) scale(0.8)"}),e.jsx("path",{d:"M18 22c1.5-3 5-3 5-3s.5 2-1 4.5-3.5 3-5 3 .5-3.5 1-4.5z",fill:"#a8a8a8",transform:"translate(4,4) scale(0.7)"}),e.jsx("text",{x:"24",y:"38",fontFamily:"Arial,sans-serif",fontSize:"9",fontWeight:"600",fill:"#a8a8a8",textAnchor:"middle",children:"tv+"})]})}function D({size:o=48,className:t=""}){return e.jsxs("svg",{viewBox:"0 0 48 48",width:o,height:o,className:t,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"canva-grad",x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"50%",stopColor:"#00c4cc"}),e.jsx("stop",{offset:"100%",stopColor:"#7c3aed"})]})}),e.jsx("rect",{width:"48",height:"48",rx:"10",fill:"url(#canva-grad)"}),e.jsx("circle",{cx:"24",cy:"24",r:"12",fill:"rgba(255,255,255,0.2)"}),e.jsx("text",{x:"24",y:"30",fontFamily:"Arial,sans-serif",fontSize:"18",fontWeight:"700",fill:"#fff",textAnchor:"middle",children:"C"})]})}function xe({size:o=48,className:t=""}){return e.jsxs("svg",{viewBox:"0 0 48 48",width:o,height:o,className:t,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"autodesk-grad",x1:"0",y1:"0",x2:"1",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#3c3c3c"}),e.jsx("stop",{offset:"100%",stopColor:"#1a1a1a"})]})}),e.jsx("rect",{width:"48",height:"48",rx:"10",fill:"url(#autodesk-grad)"}),e.jsx("polygon",{points:"24,10 38,38 10,38",fill:"none",stroke:"#00bfff",strokeWidth:"2.5"}),e.jsx("polygon",{points:"24,18 28,28 20,28",fill:"#00bfff",opacity:"0.3"}),e.jsx("text",{x:"24",y:"32",fontFamily:"Arial,sans-serif",fontSize:"9",fontWeight:"700",fill:"#fff",textAnchor:"middle",children:"A"})]})}const pe={vix:me,prime:ue,apple_tv:ge,canva_pro:D,canva_pro_annual:D,autodesk:xe};function Q(o,t=48,a=""){const r=ce[o];if(r)return e.jsx("img",{src:r,alt:o,width:t||void 0,height:t||void 0,className:`object-cover ${a}`,loading:"lazy"});const n=pe[o];return n?e.jsx(n,{size:t,className:a}):null}const be={netflix_disney_std:["netflix","disney_standard"],netflix_disney_premium:["netflix","disney_premium"],netflix_max:["netflix","max"],netflix_prime:["netflix","prime"],prime_disney_std:["prime","disney_standard"],disney_premium_max:["disney_premium","max"],max_prime:["max","prime"],paramount_max_prime:["paramount","max","prime"],mega_combo:["netflix","max","disney_premium","prime","paramount"],spotify_netflix:["spotify","netflix"],spotify_disney_premium:["spotify","disney_premium"],spotify_prime:["spotify","prime"],netflix_spotify_disney_std:["netflix","spotify","disney_standard"],netflix_spotify_prime:["netflix","spotify","prime"],disney_max:["disney_premium","max"],spotify_disney:["spotify","disney_premium"],hbomax_disney:["max","disney_premium"],netflix_hbomax:["netflix","max"],vix_prime:["vix","prime"],canva_autodesk:["canva_pro","autodesk"]};function fe(o){const t=o.toLowerCase();return t.includes("netflix")?"netflix":t.includes("disney")&&t.includes("premium")?"disney_premium":t.includes("disney")&&t.includes("standard")?"disney_standard":t.includes("disney")?"disney_premium":t.includes("max")||t.includes("hbo")?"max":t.includes("spotify")?"spotify":t.includes("prime")?"prime":t.includes("chatgpt")?"chatgpt":t.includes("deezer")?"deezer":t.includes("crunchy")?"crunchy":t.includes("paramount")?"paramount":t.includes("vix")?"vix":t.includes("youtube")?"youtube_premium":t.includes("canva")?"canva_pro":t.includes("autodesk")?"autodesk":t.includes("apple")?"apple_tv":null}function We(o,t=32,a){let r=be[o];if(!r){const l=(a||o).toLowerCase().split(/[\s+_]+/).filter(Boolean).map(fe).filter(Boolean);r=Array.from(new Set(l))}return!r||r.length===0?[]:r.map(n=>Q(n,t,"rounded-lg")).filter(Boolean)}const R="https://gfjwebngyzfftakbbmji.supabase.co",z="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdmandlYm5neXpmZnRha2JibWppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMjI1MzEsImV4cCI6MjA3Mzg5ODUzMX0.niC_FqHiHZ4EMNW86VpXX_ouIVsxftfXV8JgZxuCBGE";console.log("ðŸ” Debug - Variables hardcodeadas:");console.log("URL:",R);console.log("ANON_KEY:",z.substring(0,20)+"...");console.log("âœ… Variables configuradas correctamente");const k=R.includes("supabase.co")&&z.startsWith("eyJ")&&!R.includes("tu-proyecto")&&!z.includes("tu_clave_anonima");let g=null;if(k)try{g=se(R,z),console.log("[StreamZone] Supabase configurado correctamente")}catch(o){console.error("[StreamZone] Error configurando Supabase:",o),g=null}else console.warn("[StreamZone] Supabase no configurado. Para habilitar el guardado en la nube, crea .env.local con VITE_SUPABASE_URL y VITE_SUPABASE_ANON_KEY");const he=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede crear usuario"),{data:null,error:new Error("Supabase no configurado")};try{if(console.log("ðŸ“ Creando usuario en Supabase:",o),!o.name||!o.phone||!o.email)throw new Error("Datos de usuario incompletos");const t={name:o.name.trim(),phone:o.phone.trim(),email:o.email.trim().toLowerCase()};console.log("ðŸ“ Datos limpios para insertar:",t);const{data:a,error:r}=await g.from("users").insert([t]).select().single();if(r)throw console.error("âŒ Error de Supabase al crear usuario:",r),console.error("âŒ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return console.log("âœ… Usuario creado exitosamente:",a),{data:a,error:null}}catch(t){return console.error("âŒ Error creating user:",t),{data:null,error:t}}},ye=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede obtener usuario"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ” Buscando usuario con telÃ©fono:",o);const t=o.trim(),{data:a,error:r}=await g.from("users").select("*").eq("phone",t).single();if(r&&r.code!=="PGRST116")throw console.error("âŒ Error de Supabase al buscar usuario:",r),console.error("âŒ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return r&&r.code==="PGRST116"?(console.log("â„¹ï¸ Usuario no encontrado (esto es normal para nuevos usuarios)"),{data:null,error:null}):(console.log("âœ… Usuario encontrado:",a),{data:a,error:null})}catch(t){return console.error("âŒ Error getting user by phone:",t),{data:null,error:t}}},ve=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede crear compra"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ’¾ createPurchase: Creando compra en Supabase:",o),console.log("ðŸ’¾ createPurchase: validated =",o.validated);const t={customer:o.customer||"",phone:o.phone||"",service:o.service||"",start:o.start||new Date().toISOString().split("T")[0],end:o.end||new Date().toISOString().split("T")[0],months:o.months||1,validated:o.validated!==void 0?o.validated:!1,service_email:o.service_email||null,service_password:o.service_password||null,admin_notes:o.admin_notes||null,approved_by:o.approved_by||null,approved_at:o.approved_at||null,auto_renewal:o.auto_renewal||!1,renewal_reminder_sent:o.renewal_reminder_sent||!1,renewal_attempts:o.renewal_attempts||0,last_renewal_attempt:o.last_renewal_attempt||null,renewal_status:o.renewal_status||"none",original_purchase_id:o.original_purchase_id||null,is_renewal:o.is_renewal||!1,price:o.price||0};console.log("ðŸ’¾ createPurchase: Datos limpios:",t);const{data:a,error:r}=await g.from("purchases").insert([t]).select().maybeSingle();if(r)throw console.error("âŒ Error de Supabase al crear compra:",r),console.error("âŒ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),console.error("âŒ Datos que causaron el error:",t),console.error("âŒ Stack trace completo:",r.stack),r;return console.log("âœ… createPurchase: Compra creada exitosamente:",a),{data:a?.[0]||a,error:null}}catch(t){return console.error("âŒ Error creating purchase:",t),{data:null,error:t}}},we=async(o,t)=>{console.log("ðŸ”§ ===== updatePurchase INICIADO ====="),console.log("ðŸ†” ID recibido:",o),console.log("ðŸ“ updateData recibido:",t),console.log("ðŸ“Š Tipo de ID:",typeof o),console.log("ðŸ“Š Tipo de updateData:",typeof t);try{if(!g)throw console.error("âŒ Supabase no configurado"),new Error("Supabase no configurado");console.log("ðŸ’¾ Ejecutando update en Supabase..."),console.log("ðŸ“¤ Query:",{table:"purchases",id:o,updateData:t});const{data:a,error:r}=await g.from("purchases").update(t).eq("id",o).select().single();if(console.log("ðŸ“¥ Respuesta de Supabase:",{data:a,error:r}),r)throw console.error("âŒ Error de Supabase:",r),console.error("âŒ Detalles del error:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),r;return console.log("âœ… Update exitoso en Supabase:",a),console.log("ðŸŽ‰ ===== updatePurchase COMPLETADO ====="),{data:a,error:null}}catch(a){return console.error("âŒ ===== ERROR EN updatePurchase ====="),console.error("âŒ Error updating purchase:",a),console.error("âŒ Stack trace:",a.stack),{data:null,error:a}}},je=async()=>{try{const{data:o,error:t}=await g.from("services").select("*").order("name");if(t)throw t;return{data:o,error:null}}catch(o){return console.error("Error getting services:",o),{data:null,error:o}}},Ne=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede crear servicio"),{data:null,error:new Error("Supabase no configurado")};try{const{data:t,error:a}=await g.from("services").insert([o]).select().single();if(a)throw a;return{data:t,error:null}}catch(t){return console.error("Error creating service:",t),{data:null,error:t}}},_e=async(o,t)=>{if(!g)return console.warn("Supabase no configurado, no se puede actualizar servicio"),{data:null,error:new Error("Supabase no configurado")};try{const{data:a,error:r}=await g.from("services").update(t).eq("id",o).select().single();if(r)throw r;return{data:a,error:null}}catch(a){return console.error("Error updating service:",a),{data:null,error:a}}},Se=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede eliminar servicio"),{success:!1,error:new Error("Supabase no configurado")};try{const{error:t}=await g.from("services").delete().eq("id",o);if(t)throw t;return{success:!0,error:null}}catch(t){return console.error("Error deleting service:",t),{success:!1,error:t}}},$e=async o=>{if(!g)return console.warn("Supabase no configurado, saltando sincronizaciÃ³n de servicios"),{data:[],error:null};try{const{data:t,error:a}=await g.from("services").select("*");if(a)throw a;const r=new Map(t?.map(i=>[i.name,i])||[]),n=o.filter(i=>!r.has(i.name));if(n.length>0){const{data:i,error:l}=await g.from("services").insert(n.map(x=>({id:x.id,name:x.name,price:x.price,billing:x.billing,color:x.color,logo:x.logo,is_combo:x.is_combo||!1}))).select();if(l)throw l;console.log(`Sincronizados ${n.length} servicios nuevos`)}return{data:n,error:null}}catch(t){return console.error("Error syncing services:",t),{data:[],error:t}}},Ce=async()=>{if(!g)return console.warn("Supabase no configurado, no se pueden obtener todas las compras"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ” getAllPurchases: Obteniendo todas las compras...");const{data:o,error:t}=await g.from("purchases").select("*").order("created_at",{ascending:!1});if(t)throw console.error("âŒ Error en getAllPurchases:",t),t;return console.log("âœ… getAllPurchases: Obtenidas",o?.length||0,"compras totales"),{data:o,error:null}}catch(o){return console.error("âŒ Error getting all purchases:",o),{data:null,error:o}}},ee=async(o,t,a,r,n,i)=>{if(console.log("ðŸ” approvePurchase: Verificando configuraciÃ³n de Supabase..."),console.log("ðŸ” supabase client:",g),console.log("ðŸ” isSupabaseConfigured:",k),!g)return console.error("âŒ Supabase no configurado, no se puede aprobar compra"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ”„ Supabase: Aprobando compra...",{purchaseId:o,serviceEmail:t,servicePassword:a?"***":"undefined",adminNotes:r,approvedBy:n});const{data:l,error:x}=await g.from("purchases").update({validated:!0,service_email:t,service_password:a,admin_notes:r,approved_by:n,price:i!==void 0?i:void 0}).eq("id",o).select().single();if(x)throw console.error("âŒ Supabase Error:",x),x;return console.log("âœ… Supabase: Compra aprobada exitosamente:",l),{data:l,error:null}}catch(l){return console.error("âŒ Error approving purchase:",l),{data:null,error:l}}},Pe=async()=>{if(!g)return console.warn("Supabase no configurado, no se puede obtener compras pendientes"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ” getPendingPurchases: DIAGNÃ“STICO COMPLETO...");const{count:o,error:t}=await g.from("purchases").select("*",{count:"exact",head:!0});console.log("ðŸ“Š Total compras en BD:",o);const{count:a,error:r}=await g.from("purchases").select("*",{count:"exact",head:!0}).eq("validated",!1);console.log("â³ Compras pendientes en BD:",a);const{data:n,error:i}=await g.from("purchases").select("id, customer, validated, created_at").order("created_at",{ascending:!1}).limit(10);console.log("ðŸ“‹ Ãšltimas 10 compras:",n?.map(b=>({id:b.id,customer:b.customer,validated:b.validated,created_at:b.created_at})));let{data:l,error:x}=await g.from("purchases").select("*").eq("validated",!1).order("created_at",{ascending:!1});if(x){console.warn("âš ï¸ Error en consulta principal, intentando consulta bÃ¡sica:",x);const{data:b,error:u}=await g.from("purchases").select("id, customer, phone, service, validated, created_at, start, end, months").eq("validated",!1).order("created_at",{ascending:!1});if(u)throw console.error("âŒ Error tambiÃ©n en consulta bÃ¡sica:",u),u;l=b,x=null}return console.log("âœ… getPendingPurchases: RESULTADO FINAL - Encontradas",l?.length||0,"compras pendientes"),l&&l.length>0?console.log("ðŸ“‹ Compras pendientes encontradas:",l.map(b=>({id:b.id,customer:b.customer,validated:b.validated,created_at:b.created_at}))):console.log("âŒ NO SE ENCONTRARON COMPRAS PENDIENTES"),{data:l,error:null}}catch(o){return console.error("âŒ Error getting pending purchases:",o),{data:null,error:o}}},Ee=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede obtener compras del usuario"),{data:null,error:new Error("Supabase no configurado")};try{console.log("ðŸ” Buscando compras activas para telÃ©fono:",o);let t=o.trim();t.startsWith("+")||(t="+593"+t.replace(/[^\d]/g,"")),console.log("ðŸ“ž TelÃ©fono normalizado:",t);let{data:a,error:r}=await g.from("purchases").select("*").eq("phone",t).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});if(r)throw r;if(console.log("âœ… Compras encontradas con telÃ©fono exacto:",a?.length||0),!a||a.length===0){console.log("ðŸ” No se encontraron compras, intentando otros formatos...");const n=o.replace(/[^\d]/g,"");console.log("ðŸ“ž Intentando sin cÃ³digo de paÃ­s:",n);const{data:i,error:l}=await g.from("purchases").select("*").eq("phone",n).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});if(!l&&i&&i.length>0&&(console.log("âœ… Compras encontradas sin cÃ³digo de paÃ­s:",i.length),a=i),!a||a.length===0){const x="+593"+n;console.log("ðŸ“ž Intentando con +593:",x);const{data:b,error:u}=await g.from("purchases").select("*").eq("phone",x).eq("validated",!0).gte("end",new Date().toISOString().split("T")[0]).order("end",{ascending:!0});!u&&b&&b.length>0&&(console.log("âœ… Compras encontradas con +593:",b.length),a=b)}}return console.log("ðŸ“Š Total de compras activas encontradas:",a?.length||0),a&&a.length>0&&console.log("ðŸ“‹ Compras encontradas:",a.map(n=>({id:n.id,customer:n.customer,service:n.service,phone:n.phone,end:n.end}))),{data:a,error:null}}catch(t){return console.error("âŒ Error getting user active purchases:",t),{data:null,error:t}}},Ae=async(o=7)=>{if(!g)return console.warn("Supabase no configurado, no se puede obtener servicios prÃ³ximos a vencer"),{data:null,error:new Error("Supabase no configurado")};try{const{data:t,error:a}=await g.rpc("get_expiring_services",{days_ahead:o});if(a)throw a;return{data:t,error:null}}catch(t){return console.error("Error getting expiring services:",t),{data:null,error:t}}},Ie=async()=>{if(!g)return console.warn("Supabase no configurado, no se pueden obtener estadÃ­sticas"),{data:null,error:new Error("Supabase no configurado")};try{const{data:o,error:t}=await g.from("purchases").select("auto_renewal, is_renewal, end, validated");if(t)throw t;return{data:{totalPurchases:o.length,autoRenewalEnabled:o.filter(r=>r.auto_renewal).length,renewalPurchases:o.filter(r=>r.is_renewal).length,expiringThisWeek:o.filter(r=>{const n=new Date(r.end),i=new Date,l=new Date(i.getTime()+10080*60*1e3);return n>=i&&n<=l&&r.validated}).length,expiredServices:o.filter(r=>new Date(r.end)<new Date&&r.validated).length},error:null}}catch(o){return console.error("Error getting renewal stats:",o),{data:null,error:o}}},re=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede buscar usuario"),{data:null,error:new Error("Supabase no configurado")};try{const{data:t,error:a}=await g.from("users").select("*").eq("email",o.toLowerCase().trim()).single();if(a&&a.code!=="PGRST116")throw a;return{data:t,error:null}}catch(t){return console.error("Error buscando usuario por email:",t),{data:null,error:t}}},Me=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede generar token"),{data:null,error:new Error("Supabase no configurado")};try{if(!(await re(o)).data)return{data:null,error:{message:`No existe un usuario con el email: ${o}. Verifica que el email sea correcto o crea una cuenta primero.`}};const a=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r=new Date(Date.now()+1800*1e3),{data:n,error:i}=await g.from("users").update({reset_token:a,reset_token_expires:r.toISOString()}).eq("email",o.toLowerCase().trim()).select().single();if(i)throw i;return{data:{token:a,user:n},error:null}}catch(t){return console.error("Error generando token de recuperaciÃ³n:",t),{data:null,error:t}}},te=async o=>{if(!g)return console.warn("Supabase no configurado, no se puede verificar token"),{data:null,error:new Error("Supabase no configurado")};try{const{data:t,error:a}=await g.from("users").select("*").eq("reset_token",o).gt("reset_token_expires",new Date().toISOString()).single();if(a&&a.code!=="PGRST116")throw a;return{data:t,error:null}}catch(t){return console.error("Error verificando token:",t),{data:null,error:t}}},Te=async(o,t)=>{if(!g)return console.warn("Supabase no configurado, no se puede restablecer contraseÃ±a"),{data:null,error:new Error("Supabase no configurado")};try{if(!(await te(o)).data)return{data:null,error:{message:"Token invÃ¡lido o expirado"}};const{data:r,error:n}=await g.from("users").update({password:t,reset_token:null,reset_token_expires:null}).eq("reset_token",o).select().single();if(n)throw n;return{data:r,error:null}}catch(a){return console.error("Error restableciendo contraseÃ±a:",a),{data:null,error:a}}},Oe=async(o,t)=>{if(!g)return console.warn("Supabase no configurado, no se puede hacer login"),{data:null,error:new Error("Supabase no configurado")};try{const{data:a,error:r}=await g.from("users").select("*").eq("email",o.toLowerCase().trim()).eq("password",t).single();if(r&&r.code!=="PGRST116")throw r;return{data:a,error:null}}catch(a){return console.error("Error en login:",a),{data:null,error:a}}},Fe=Object.freeze(Object.defineProperty({__proto__:null,approvePurchase:ee,createPurchase:ve,createService:Ne,createUser:he,deleteService:Se,generateResetToken:Me,getAllPurchases:Ce,getExpiringServices:Ae,getPendingPurchases:Pe,getRenewalStats:Ie,getServices:je,getUserActivePurchases:Ee,getUserByEmail:re,getUserByPhone:ye,loginUser:Oe,resetPassword:Te,get supabase(){return g},syncServices:$e,updatePurchase:we,updateService:_e,verifyResetToken:te},Symbol.toStringTag,{value:"Module"})),Re=[{code:"+593",name:"Ecuador",flag:"ðŸ‡ªðŸ‡¨"},{code:"+1",name:"Estados Unidos",flag:"ðŸ‡ºðŸ‡¸"},{code:"+1",name:"CanadÃ¡",flag:"ðŸ‡¨ðŸ‡¦"},{code:"+52",name:"MÃ©xico",flag:"ðŸ‡²ðŸ‡½"},{code:"+54",name:"Argentina",flag:"ðŸ‡¦ðŸ‡·"},{code:"+55",name:"Brasil",flag:"ðŸ‡§ðŸ‡·"},{code:"+56",name:"Chile",flag:"ðŸ‡¨ðŸ‡±"},{code:"+57",name:"Colombia",flag:"ðŸ‡¨ðŸ‡´"},{code:"+51",name:"PerÃº",flag:"ðŸ‡µðŸ‡ª"},{code:"+58",name:"Venezuela",flag:"ðŸ‡»ðŸ‡ª"},{code:"+34",name:"EspaÃ±a",flag:"ðŸ‡ªðŸ‡¸"},{code:"+49",name:"Alemania",flag:"ðŸ‡©ðŸ‡ª"},{code:"+33",name:"Francia",flag:"ðŸ‡«ðŸ‡·"},{code:"+44",name:"Reino Unido",flag:"ðŸ‡¬ðŸ‡§"},{code:"+39",name:"Italia",flag:"ðŸ‡®ðŸ‡¹"},{code:"+86",name:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"+81",name:"JapÃ³n",flag:"ðŸ‡¯ðŸ‡µ"},{code:"+82",name:"Corea del Sur",flag:"ðŸ‡°ðŸ‡·"},{code:"+91",name:"India",flag:"ðŸ‡®ðŸ‡³"},{code:"+61",name:"Australia",flag:"ðŸ‡¦ðŸ‡º"}];function Je({open:o,onClose:t,service:a,user:r,isDark:n,onPurchase:i}){const[l,x]=P.useState(""),[b,u]=P.useState(1),[f,j]=P.useState(1),[h,p]=P.useState("");if(!o||!a)return null;const c=a.billing==="annual",$=a.price*b*f,N=()=>{if(console.log("ðŸ›’ Iniciando compra para usuario registrado..."),!r){console.warn("âš ï¸ Usuario no registrado - compra bloqueada");return}const _={name:r.name||"Cliente",phone:r.phone||"+593000000000",email:r.email||"cliente@streamzone.com"};let E=_.phone;E.startsWith("+")||(E="+593"+E.replace(/[^\d]/g,""));const I=a?.name||"Servicio Premium",T=a?.price||10,M=b>0?b:1,m=f>0?f:1,y={service:I,price:T,duration:M,devices:m,total:T*M*m,paymentMethod:"pichincha",notes:h||"",customer:_.name,phone:E,email:_.email,start:new Date().toISOString().slice(0,10),end:new Date(Date.now()+(c?M*365:M*30)*24*60*60*1e3).toISOString().slice(0,10)};console.log("âœ… Datos de compra garantizados:",y);try{i(y),console.log("ðŸŽ‰ Compra procesada exitosamente"),t()}catch(C){console.warn("âš ï¸ Error en onPurchase, pero continuando con panel de agentes:",C),t()}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-md p-2 sm:p-4",onClick:t,children:e.jsxs("div",{className:`w-full max-w-xs sm:max-w-md md:max-w-lg max-h-[95vh] sm:max-h-[90vh] rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-2xl overflow-y-auto border-2 ${s(n,"bg-white border-gray-200","bg-zinc-900 border-zinc-700 text-zinc-100")}`,onClick:_=>_.stopPropagation(),children:[e.jsxs("div",{className:"mb-3 sm:mb-4 md:mb-6 flex items-center justify-between",children:[e.jsx("h3",{className:`text-lg sm:text-xl md:text-2xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Completar Compra"}),e.jsx("button",{onClick:t,className:`w-8 h-8 sm:w-9 sm:h-9 rounded-full flex items-center justify-center text-lg font-bold transition-colors shadow-md ${s(n,"text-gray-600 hover:text-gray-800 hover:bg-gray-100 border border-gray-300","text-zinc-200 hover:text-white hover:bg-zinc-800 border border-zinc-600")}`,children:"Ã—"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-xl sm:rounded-2xl p-3 sm:p-4 border ${s(n,"bg-gray-50 border-gray-200","bg-zinc-800 border-zinc-600")}`,children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[(()=>{const _=Q(a.id,0,"w-full h-full object-cover");return _?e.jsx("div",{className:"h-12 w-12 sm:h-16 sm:w-16 rounded-xl overflow-hidden shadow-lg flex-shrink-0",children:_}):a.logo?.startsWith("http")?e.jsx("div",{className:"h-12 w-12 sm:h-16 sm:w-16 rounded-xl overflow-hidden shadow-lg flex-shrink-0",children:e.jsx("img",{src:a.logo,alt:a.name,className:"w-full h-full object-cover",loading:"lazy"})}):e.jsx("div",{className:`h-12 w-12 sm:h-16 sm:w-16 ${a.color} rounded-xl text-white grid place-content-center text-lg sm:text-2xl font-bold shadow-lg flex-shrink-0`,children:a.logo})})(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`text-base sm:text-lg font-bold truncate ${s(n,"text-gray-900","text-white")}`,children:a.name}),e.jsxs("p",{className:`text-xs sm:text-sm font-semibold ${s(n,"text-gray-800","text-gray-200")}`,children:[J(a.price)," por ",c?"aÃ±o":"mes"]})]})]})}),!r&&e.jsx("div",{className:`rounded-xl sm:rounded-2xl p-4 border ${s(n,"bg-red-50 border-red-200","bg-red-900/20 border-red-600")}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-lg",children:"ðŸ”"})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-semibold ${s(n,"text-red-900","text-red-200")}`,children:"Registro Requerido"}),e.jsx("p",{className:`text-xs ${s(n,"text-red-700","text-red-300")}`,children:"Debes iniciar sesiÃ³n para realizar compras"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-3 ${s(n,"text-gray-900","text-white")}`,children:"DuraciÃ³n"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[1,2,3,6].map(_=>e.jsxs("button",{type:"button",onClick:()=>u(_),className:`px-3 py-2 sm:px-4 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-semibold transition-all duration-200 border-2 shadow-md ${b===_?"bg-blue-600 text-white border-blue-700 shadow-lg transform scale-105":s(n,"bg-gray-100 text-gray-800 border-gray-400 hover:bg-gray-200 hover:border-gray-600 hover:shadow-lg","bg-gray-700 text-gray-200 border-gray-500 hover:bg-gray-600 hover:border-gray-400 hover:shadow-lg")}`,children:[_," ",c?_===1?"aÃ±o":"aÃ±os":_===1?"mes":"meses"]},_))})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-3 ${s(n,"text-gray-900","text-white")}`,children:"NÃºmero de Dispositivos"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[e.jsx("button",{type:"button",onClick:()=>f>1&&j(f-1),disabled:f<=1,className:`w-9 h-9 sm:w-11 sm:h-11 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold transition-all border-2 shadow-md ${f<=1?s(n,"bg-gray-200 text-gray-400 cursor-not-allowed border-gray-300","bg-gray-600 text-gray-500 cursor-not-allowed border-gray-500"):s(n,"bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg","bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg")}`,children:"âˆ’"}),e.jsxs("div",{className:`border-2 rounded-xl px-4 sm:px-6 py-2 sm:py-3 min-w-[100px] sm:min-w-[120px] text-center shadow-lg ${s(n,"bg-blue-100 border-blue-700","bg-blue-900 border-blue-500")}`,children:[e.jsx("div",{className:`text-2xl sm:text-3xl font-bold ${s(n,"text-blue-900","text-blue-100")}`,children:f}),e.jsx("div",{className:`text-xs sm:text-sm font-bold ${s(n,"text-blue-800","text-blue-200")}`,children:f===1?"Dispositivo":"Dispositivos"})]}),e.jsx("button",{type:"button",onClick:()=>f<5&&j(f+1),disabled:f>=5,className:`w-9 h-9 sm:w-11 sm:h-11 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold transition-all border-2 shadow-md ${f>=5?s(n,"bg-gray-200 text-gray-400 cursor-not-allowed border-gray-300","bg-gray-600 text-gray-500 cursor-not-allowed border-gray-500"):s(n,"bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg","bg-blue-600 text-white hover:bg-blue-700 border-blue-700 shadow-lg")}`,children:"+"})]}),e.jsx("div",{className:`mt-2 text-xs ${s(n,"text-gray-600","text-gray-300")}`,children:"MÃ¡ximo 5 dispositivos por compra"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold mb-3 sm:mb-4 text-sm sm:text-base ${s(n,"text-gray-800","text-gray-200")}`,children:"ðŸ’³ InformaciÃ³n de Pago"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-3 sm:p-4 text-white shadow-lg border-2 border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:"ðŸ¦"}),e.jsx("span",{className:"font-bold text-sm sm:text-base text-white",children:"Banco Pichincha"})]}),e.jsxs("div",{className:"text-xs sm:text-sm space-y-1 text-white",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Jeremias Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 2209034638"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorro Transaccional"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-700 to-purple-700 rounded-xl p-3 sm:p-4 text-white shadow-lg border-2 border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:"ðŸ›ï¸"}),e.jsx("span",{className:"font-bold text-sm sm:text-base text-white",children:"Banco Guayaquil"})]}),e.jsxs("div",{className:"text-xs sm:text-sm space-y-1 text-white",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Jeremias Joel Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 0122407273"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorros"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg p-3 sm:p-4 text-white shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-base sm:text-lg",children:"ðŸŒŠ"}),e.jsx("span",{className:"font-semibold text-xs sm:text-sm text-white",children:"Banco PacÃ­fico"})]}),e.jsxs("div",{className:"text-xs space-y-1 text-purple-100",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Titular:"})," Byron Guale Santana"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Cuenta:"})," 1061220256"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Ahorros"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-400 to-purple-500 rounded-lg p-3 sm:p-4 text-white shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-base sm:text-lg",children:"ðŸ’³"}),e.jsx("span",{className:"font-semibold text-xs sm:text-sm text-white",children:"PayPal"})]}),e.jsxs("div",{className:"text-xs space-y-1 text-blue-100",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Email:"})," guale2023@outlook.com"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"MÃ©todo:"})," PayPal"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Tipo:"})," Transferencia"]})]})]})]}),e.jsx("div",{className:`mt-3 sm:mt-4 p-4 sm:p-6 rounded-2xl ${s(n,"bg-gradient-to-br from-orange-50 to-yellow-50 border-2 border-orange-200","bg-gradient-to-br from-orange-900/30 to-yellow-900/30 border-2 border-orange-500")}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3 sm:mb-4",children:e.jsx("div",{className:`p-3 sm:p-4 rounded-full ${s(n,"bg-orange-100","bg-orange-800/50")}`,children:e.jsx("span",{className:"text-3xl sm:text-4xl",children:"ðŸš¨"})})}),e.jsx("h5",{className:"text-lg sm:text-xl font-bold text-orange-800 dark:text-orange-200 mb-2 sm:mb-3",children:"âš ï¸ Instrucciones Importantes"}),e.jsxs("div",{className:`p-3 sm:p-4 rounded-xl ${s(n,"bg-white/80","bg-black/20")}`,children:[e.jsxs("p",{className:"text-xs sm:text-sm text-orange-700 dark:text-orange-300 mb-3 sm:mb-4",children:["Una vez que hayas realizado el pago, ",e.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"debes confirmar tu compra"})," enviando una captura del comprobante por WhatsApp a nuestros agentes."]}),e.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:`px-3 sm:px-4 py-2 rounded-lg ${s(n,"bg-green-100 text-green-800","bg-green-800/50 text-green-200")}`,children:[e.jsx("span",{className:"text-base sm:text-lg",children:"ðŸ“±"}),e.jsx("span",{className:"ml-1 sm:ml-2 font-semibold text-xs sm:text-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:`px-3 sm:px-4 py-2 rounded-lg ${s(n,"bg-blue-100 text-blue-800","bg-blue-800/50 text-blue-200")}`,children:[e.jsx("span",{className:"text-base sm:text-lg",children:"ðŸ’¬"}),e.jsx("span",{className:"ml-1 sm:ml-2 font-semibold text-xs sm:text-sm",children:"Agentes"})]})]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 font-medium",children:"âš¡ Sin el comprobante, tu servicio NO serÃ¡ activado"})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm sm:text-base font-semibold mb-2 ${s(n,"text-gray-900","text-white")}`,children:"Notas adicionales (opcional)"}),e.jsx("textarea",{value:h,onChange:_=>p(_.target.value),placeholder:"Comentarios o instrucciones especiales...",className:`w-full rounded-lg border-2 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm resize-none shadow-md ${s(n,"border-gray-400 bg-white text-gray-900 focus:border-blue-500","border-gray-500 bg-gray-700 text-gray-100 focus:border-blue-400")}`,rows:2})]}),e.jsx("div",{className:`bg-gradient-to-r border-2 rounded-xl p-4 sm:p-6 shadow-lg ${s(n,"from-blue-100 to-purple-100 border-blue-600","from-blue-900 to-purple-900 border-blue-500")}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`text-lg sm:text-xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Total a pagar:"}),e.jsx("span",{className:`text-2xl sm:text-3xl font-black ${s(n,"text-blue-800","text-blue-200")}`,children:J($)})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 pt-2",children:[e.jsx("button",{onClick:t,className:`flex-1 rounded-lg sm:rounded-xl px-4 sm:px-6 py-3 sm:py-4 font-bold transition-all text-sm sm:text-base border-2 shadow-md ${s(n,"bg-gray-100 text-gray-800 hover:bg-gray-200 border-gray-400","bg-gray-700 text-gray-200 hover:bg-gray-600 border-gray-500")}`,children:"Cancelar"}),e.jsx("button",{onClick:N,disabled:!r,className:`flex-1 rounded-lg sm:rounded-xl px-4 sm:px-6 py-3 sm:py-4 font-bold transition-all shadow-lg text-sm sm:text-base border-2 transform ${r?"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-xl border-blue-700 hover:scale-105":"bg-gray-400 text-gray-600 cursor-not-allowed border-gray-500"}`,children:r?"ðŸ›’ Completar Compra":"ðŸ” Registro Requerido"})]})]})]})})}const X=[{id:"netflix",name:"Netflix",price:4,billing:"monthly",color:"bg-red-600",logo:"N"},{id:"disney_premium",name:"Disney+ Premium",price:3.75,billing:"monthly",color:"bg-blue-600",logo:"D+"},{id:"disney_standard",name:"Disney+ Standard",price:3.25,billing:"monthly",color:"bg-blue-500",logo:"D+"},{id:"max",name:"Max",price:3,billing:"monthly",color:"bg-purple-700",logo:"MAX"},{id:"vix",name:"ViX",price:2.5,billing:"monthly",color:"bg-orange-500",logo:"ViX"},{id:"prime",name:"Prime Video",price:3,billing:"monthly",color:"bg-sky-700",logo:"PV"},{id:"youtube_premium",name:"YouTube Premium",price:3.35,billing:"monthly",color:"bg-red-700",logo:"YT"},{id:"paramount",name:"Paramount+",price:2.75,billing:"monthly",color:"bg-indigo-600",logo:"P+"},{id:"chatgpt",name:"ChatGPT",price:4,billing:"monthly",color:"bg-zinc-800",logo:"GPT"},{id:"crunchy",name:"Crunchyroll",price:2.5,billing:"monthly",color:"bg-orange-600",logo:"CR"},{id:"spotify",name:"Spotify",price:3.5,billing:"monthly",color:"bg-emerald-600",logo:"SP"},{id:"deezer",name:"Deezer",price:3,billing:"monthly",color:"bg-blue-700",logo:"DZ"},{id:"apple_tv",name:"Apple TV+",price:3.5,billing:"monthly",color:"bg-neutral-900",logo:"ATV"},{id:"canva_pro",name:"Canva Pro",price:2,billing:"monthly",color:"bg-indigo-500",logo:"C"},{id:"canva_pro_annual",name:"Canva Pro (1 aÃ±o)",price:17.5,billing:"annual",color:"bg-indigo-600",logo:"C"},{id:"microsoft365",name:"Microsoft 365 (1 aÃ±o)",price:15,billing:"annual",color:"bg-blue-500",logo:"M365"},{id:"autodesk",name:"Autodesk (1 aÃ±o)",price:12.5,billing:"annual",color:"bg-zinc-700",logo:"AD"},{id:"office365",name:"Office 365 (1 aÃ±o)",price:15,billing:"annual",color:"bg-blue-600",logo:"O365"}],Z=[{id:"netflix_disney_std",name:"Netflix + Disney EstÃ¡ndar",price:6,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-500",logo:"N+D"},{id:"netflix_disney_premium",name:"Netflix + Disney Premium",price:6.5,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-blue-600",logo:"N+D+"},{id:"netflix_max",name:"Netflix + Max",price:6,billing:"monthly",color:"bg-gradient-to-r from-red-600 to-purple-700",logo:"N+MAX"},{id:"disney_max",name:"Disney + Max",price:5.5,billing:"monthly",color:"bg-gradient-to-r from-blue-600 to-purple-700",logo:"D+MAX"},{id:"spotify_disney",name:"Spotify + Disney",price:5,billing:"monthly",color:"bg-gradient-to-r from-emerald-600 to-blue-500",logo:"SP+D+"},{id:"netflix_spotify_disney_std",name:"Netflix + Spotify + Disney Standar",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-blue-500",logo:"N+SP+D"},{id:"netflix_spotify_prime",name:"Netflix + Spotify + Prime Video",price:8,billing:"monthly",color:"bg-gradient-to-r from-red-600 via-emerald-600 to-sky-700",logo:"N+SP+PV"}];function De({open:o,onClose:t,onRegister:a,isDark:r,systemPrefersDark:n}){const[i,l]=P.useState({name:"",phone:"",countryCode:"+593",email:"",service:"",price:"",duration:1,isAnnual:!1,startDate:new Date().toISOString().slice(0,10),service_email:"",service_password:"",admin_notes:""});if(P.useEffect(()=>{if(i.service){const u=X.find(j=>j.name===i.service);if(u){const j=u.price*i.duration;l(h=>({...h,price:j.toString()}));return}const f=Z.find(j=>j.name===i.service);if(f){const j=f.price*i.duration;l(h=>({...h,price:j.toString()}))}}},[i.service,i.duration]),!o)return null;const x=u=>{if(u.preventDefault(),!i.name||!i.phone||!i.service||!i.service_email||!i.service_password){alert("âš ï¸ Por favor completa todos los campos requeridos, incluyendo las credenciales del servicio");return}const f=de(i.phone,i.countryCode),j=new Date(i.startDate),h=i.isAnnual?i.duration*12:i.duration;j.setDate(j.getDate()+h*30),a({...i,phone:f,price:parseFloat(i.price),endDate:j.toISOString().slice(0,10),months:h}),l({name:"",phone:"",countryCode:"+593",email:"",service:"",price:"",duration:1,isAnnual:!1,startDate:new Date().toISOString().slice(0,10),service_email:"",service_password:"",admin_notes:""}),t()},b=()=>{if(!i.phone||!i.service_email||!i.service_password){alert("âš ï¸ Por favor completa todos los campos requeridos antes de enviar por WhatsApp");return}const u=new Date(i.startDate),f=i.isAnnual?i.duration*12:i.duration;u.setDate(u.getDate()+f*30);const j=u.toISOString().slice(0,10),h=`â˜… StreamZone â˜…
Â¡Compra Aprobada! ðŸš€

Â¡Hola ${i.name}! Tu servicio ${i.service} ya esta activo. âœ“

ðŸ”‘ CREDENCIALES:
Email: ${i.service_email}
Pass: ${i.service_password}

ðŸ“… Duracion: ${f} ${f===1?"mes":"meses"}
â° Vence: ${j}
ðŸ’Ž Â¡Disfruta tu entretenimiento!`,c=`https://api.whatsapp.com/send?phone=${B(i.phone)}&text=${encodeURIComponent(h)}`;window.open(c,"_blank")};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:t,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${s(r,"bg-white","bg-gray-900")}`,onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${s(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Registrar Compra Manual"}),e.jsx("button",{onClick:t,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${s(r,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"Ã—"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200","bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border-blue-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-blue-100","bg-blue-900/30")}`,children:"ðŸ‘¤"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"InformaciÃ³n del Cliente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸ‘¤ Nombre del Cliente *"}),e.jsx("input",{type:"text",value:i.name,onChange:u=>l({...i,name:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"Nombre completo del cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸ“± TelÃ©fono *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:i.countryCode,onChange:u=>l({...i,countryCode:u.target.value}),className:`w-28 sm:w-32 rounded-xl border-2 px-2 sm:px-3 py-3 text-xs sm:text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,children:Re.map(u=>e.jsxs("option",{value:u.code,children:[u.flag," ",u.code]},u.code))}),e.jsx("input",{type:"tel",value:i.phone,onChange:u=>l({...i,phone:u.target.value}),className:`flex-1 min-w-0 rounded-xl border-2 px-3 sm:px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"99 999 9999",required:!0})]}),e.jsxs("div",{className:`text-xs ${s(r,"text-gray-500","text-gray-400")}`,children:["NÃºmero completo: ",i.countryCode," ",i.phone]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200","bg-gradient-to-br from-green-900/20 to-emerald-900/20 border-green-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-green-100","bg-green-900/30")}`,children:"ðŸŽ¬"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Servicio y DuraciÃ³n"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸŽ¬ Servicio *"}),e.jsxs("select",{value:i.service,onChange:u=>l({...i,service:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")}`,required:!0,children:[e.jsx("option",{value:"",children:"Selecciona un servicio"}),e.jsx("optgroup",{label:"ðŸŽ¬ Servicios Individuales",children:X.map(u=>e.jsxs("option",{value:u.name,children:[u.name," - $",u.price,"/mes"]},u.name))}),e.jsx("optgroup",{label:"ðŸŽ Combos Especiales",children:Z.map(u=>e.jsxs("option",{value:u.name,children:[u.name," - $",u.price,"/mes"]},u.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"â±ï¸ DuraciÃ³n (meses) *"}),e.jsxs("select",{value:i.duration,onChange:u=>l({...i,duration:Number(u.target.value)}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")}`,required:!0,children:[e.jsx("option",{value:1,children:"1 mes"}),e.jsx("option",{value:3,children:"3 meses"}),e.jsx("option",{value:6,children:"6 meses"}),e.jsx("option",{value:12,children:"12 meses"})]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸ’° Precio Total"}),e.jsxs("div",{className:`p-3 rounded-lg ${s(r,"bg-green-100 border border-green-200","bg-green-900/20 border border-green-600")}`,children:[e.jsxs("p",{className:`text-lg font-bold ${s(r,"text-green-800","text-green-300")}`,children:["$",i.price||"0.00"," USD"]}),e.jsxs("p",{className:`text-sm ${s(r,"text-green-700","text-green-400")}`,children:[i.duration," ",i.duration===1?"mes":"meses"," de ",i.service||"servicio"]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200","bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-yellow-100","bg-yellow-900/30")}`,children:"ðŸ”‘"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸ“§ Email del servicio *"}),e.jsx("input",{type:"email",value:i.service_email,onChange:u=>l({...i,service_email:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,placeholder:"usuario@servicio.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ðŸ” ContraseÃ±a del servicio *"}),e.jsx("input",{type:"text",value:i.service_password,onChange:u=>l({...i,service_password:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200","bg-gradient-to-br from-amber-900/20 to-orange-900/20 border-amber-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-amber-100","bg-amber-900/30")}`,children:"ðŸ“"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Notas del Administrador"})]}),e.jsx("textarea",{value:i.admin_notes,onChange:u=>l({...i,admin_notes:u.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-amber-500 focus:ring-amber-200","border-gray-600 bg-gray-700 text-white focus:border-amber-400 focus:ring-amber-800/30")}`,rows:4,placeholder:"Escribe informaciÃ³n importante para el cliente (puedes usar saltos de lÃ­nea)..."}),e.jsx("div",{className:`mt-3 p-3 rounded-lg ${s(r,"bg-amber-100 border border-amber-200","bg-amber-900/20 border border-amber-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${s(r,"text-amber-800","text-amber-300")}`,children:["ðŸ’¡ ",e.jsx("strong",{children:"Nota:"})," Esta informaciÃ³n serÃ¡ visible para el cliente y puede incluir instrucciones especiales, detalles de renovaciÃ³n, o cualquier informaciÃ³n relevante."]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:t,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 ${s(r,"bg-gray-200 text-gray-800 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"âŒ"}),e.jsx("span",{children:"Cancelar"})]})}),e.jsxs("button",{type:"button",onClick:b,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 ${s(r,"bg-green-500 text-white hover:bg-green-600 shadow-lg hover:shadow-xl","bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-xl")}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸ“±"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsxs("button",{type:"submit",className:"w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’¾"}),e.jsx("span",{className:"truncate",children:"Registrar Compra"})]})]})]})})]})})}function Xe({open:o,onClose:t,onUpdate:a,purchase:r,isDark:n,systemPrefersDark:i}){const l=r?.service||"",x=l.trim(),b=/^Disney\+?\s*$/i.test(x)||/^Disney\+?\s+(Standard|EstÃ¡ndar|Premium)\s*$/i.test(x)||/^Disney\s+(Standard|EstÃ¡ndar|Premium)\s*$/i.test(x),u=x.includes("Netflix")||x.includes("Max")||x.includes("Prime")||x.includes("Spotify")||x.includes("Paramount")||/\s+\+\s+/.test(x),f=b&&!u,j=/\s+\+\s+/.test(l),h=!f&&j;let p=[l];h&&(l.includes("Netflix")&&l.includes("Disney")?p=["Netflix",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Max")&&l.includes("Prime")?p=["Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")?p=["Netflix","Max"]:l.includes("Netflix")&&l.includes("Prime")?p=["Netflix","Prime Video"]:l.includes("Prime")&&l.includes("Disney")?p=["Prime Video",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Disney")&&l.includes("Max")?p=[l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar","Max"]:l.includes("Spotify")&&l.includes("Netflix")?p=["Spotify","Netflix"]:l.includes("Spotify")&&l.includes("Disney")?p=["Spotify",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Spotify")&&l.includes("Prime")?p=["Spotify","Prime Video"]:l.includes("Paramount")&&l.includes("Max")&&l.includes("Prime")?p=["Paramount+","Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")&&l.includes("Disney")?p=["Netflix","Max",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar","Prime Video","Paramount+"]:p=l.split(/\s*\+\s*/).map(d=>d.trim()).filter(d=>d.length>0));const[c,$]=P.useState({customer:"",phone:"",service:"",start:"",end:"",months:1,service_email:"",service_password:"",admin_notes:"",price:0}),[N,_]=P.useState(!1),[E,I]=P.useState({}),T=(d,v)=>{if(!d)return"";const S=new Date(d),w=new Date(S);return w.setDate(w.getDate()+v*30),w.toISOString().split("T")[0]},M=d=>{$(v=>({...v,start:d,end:T(d,v.months)}))},m=d=>{$(v=>{const S={...v,months:d,end:T(v.start,d)},w=q.find(A=>A.name===v.service)||G.find(A=>A.name===v.service);return w&&(S.price=w.price*d),S})};if(P.useEffect(()=>{if(o&&r){const d=q.find(v=>v.name===c.service)||G.find(v=>v.name===c.service);if(d){const v=d.price*c.months;c.price===0&&$(S=>({...S,price:v}))}}},[c.service,c.months,o,r]),P.useEffect(()=>{if(r&&($({customer:r.customer||"",phone:r.phone||"",service:r.service||"",start:r.start||"",end:r.end||"",months:r.months||1,service_email:r.service_email||"",service_password:r.service_password||"",admin_notes:r.admin_notes||"",price:r.price||0}),h&&r.service_password)){const d={};r.service_password.split(`

`).forEach(S=>{const w=S.split(`
`);if(w.length>=3){const A=w[0].replace(":","").trim(),L=w[1].replace("Email: ","").trim(),U=w[2].replace("ContraseÃ±a: ","").trim();A&&L&&U&&(d[A]={email:L,password:U})}}),I(d),console.log("ðŸ“‹ Credenciales parseadas:",d)}},[r,h]),!o||!r)return null;const y=d=>{d.preventDefault();let v={...c};if(h){const S=p.map(w=>{const A=E[w];return A?.email&&A?.password?`${w}:
Email: ${A.email}
ContraseÃ±a: ${A.password}`:""}).filter(w=>w.length>0).join(`

`);v.service_email=`COMBO: ${p.join(" + ")}`,v.service_password=S}a(v),t()},C=()=>{let d=c.service_email&&c.service_password?`Email: ${c.service_email}
Pass: ${c.service_password}`:"";h&&c.service_password.includes("Email:")&&(d=c.service_password.replace(/Email: /g,"").replace(/ContraseÃ±a: /g,"/ "));const v=`â˜… StreamZone â˜…
Â¡ActualizaciÃ³n Exitosa! âœ¨

Â¡Hola ${c.customer}! Tu servicio ${c.service} ya esta listo. âœ“

ðŸ”‘ CREDENCIALES:
${d}

ðŸ“… Duracion: ${c.months} ${c.months===1?"mes":"meses"}
â° Vence: ${c.end}
ðŸ’Ž Â¡Disfruta tu entretenimiento!`,w=`https://api.whatsapp.com/send?phone=${B(c.phone)}&text=${encodeURIComponent(v)}`;window.open(w,"_blank")};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:t,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${s(n,"bg-white","bg-gray-900")}`,onClick:d=>d.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${s(n,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Editar Compra"}),e.jsx("button",{onClick:t,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${s(n,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"Ã—"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(n,"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200","bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border-blue-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(n,"bg-blue-100","bg-blue-900/30")}`,children:"ðŸ‘¤"}),e.jsx("h4",{className:`text-xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"InformaciÃ³n del Cliente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ðŸ‘¤ Nombre del Cliente *"}),e.jsx("input",{type:"text",value:c.customer,onChange:d=>$({...c,customer:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"Nombre completo del cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ðŸ“± TelÃ©fono *"}),e.jsx("input",{type:"tel",value:c.phone,onChange:d=>$({...c,phone:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-200","border-gray-600 bg-gray-700 text-white focus:border-blue-400 focus:ring-blue-800/30")}`,placeholder:"+593 99 999 9999",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ðŸ’° Precio de Venta *"}),e.jsx("input",{type:"number",step:"0.01",value:c.price,readOnly:!0,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-bold transition-all bg-gray-100 cursor-not-allowed ${s(n,"border-gray-300 text-gray-500","border-gray-600 bg-gray-800 text-gray-400")}`,placeholder:"0.00"})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(n,"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200","bg-gradient-to-br from-green-900/20 to-emerald-900/20 border-green-700")}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(n,"bg-green-100","bg-green-900/30")}`,children:"ðŸ“…"}),e.jsx("h4",{className:`text-xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Fechas y DuraciÃ³n"})]}),e.jsx("button",{type:"button",onClick:()=>_(!N),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${s(n,"bg-green-100 text-green-800 hover:bg-green-200","bg-green-900/30 text-green-200 hover:bg-green-800/40")}`,children:N?"ðŸ”’ Bloquear":"âœï¸ Editar Fechas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ðŸ“… Fecha de Inicio *"}),e.jsx("input",{type:"date",value:c.start,onChange:d=>M(d.target.value),disabled:!N,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${N?"":"opacity-60 cursor-not-allowed"}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"â±ï¸ DuraciÃ³n (meses) *"}),e.jsxs("select",{value:c.months,onChange:d=>m(Number(d.target.value)),disabled:!N,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${N?"":"opacity-60 cursor-not-allowed"}`,required:!0,children:[e.jsx("option",{value:1,children:"1 mes"}),e.jsx("option",{value:3,children:"3 meses"}),e.jsx("option",{value:6,children:"6 meses"}),e.jsx("option",{value:12,children:"12 meses"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ðŸ Fecha de Fin"}),e.jsx("input",{type:"date",value:c.end,onChange:d=>$({...c,end:d.target.value}),disabled:!N,className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-green-500 focus:ring-green-200","border-gray-600 bg-gray-700 text-white focus:border-green-400 focus:ring-green-800/30")} ${N?"":"opacity-60 cursor-not-allowed"}`})]})]}),N&&e.jsx("div",{className:`mt-4 p-3 rounded-lg ${s(n,"bg-green-100 border border-green-200","bg-green-900/20 border border-green-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${s(n,"text-green-800","text-green-300")}`,children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," La fecha de fin se calcula automÃ¡ticamente basada en la fecha de inicio y duraciÃ³n. Ãštil para renovaciones o ajustes de fechas."]})})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(n,"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200","bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(n,"bg-yellow-100","bg-yellow-900/30")}`,children:"ðŸ”‘"}),e.jsx("h4",{className:`text-xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),h?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${s(n,"bg-orange-50 border border-orange-200","bg-orange-900/20 border border-orange-600")}`,children:e.jsx("p",{className:`text-sm font-semibold ${s(n,"text-orange-800","text-orange-300")}`,children:"ðŸŽ Combo detectado: Edita las credenciales para cada servicio"})}),p.map((d,v)=>e.jsxs("div",{className:`p-4 rounded-lg border ${s(n,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-600")}`,children:[e.jsxs("h5",{className:`text-lg font-bold mb-3 ${s(n,"text-gray-800","text-white")}`,children:[d," ",v===0?"ðŸŽ¬":v===1?"ðŸŽ­":v===2?"ðŸŽª":"ðŸŽ¯"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${s(n,"text-gray-700","text-gray-300")}`,children:["ðŸ“§ Email del ",d]}),e.jsx("input",{type:"email",value:E[d]?.email||"",onChange:S=>I(w=>({...w,[d]:{...w[d],email:S.target.value,password:w[d]?.password||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500/20 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-blue-500","border-gray-600 bg-gray-700 text-white focus:border-blue-400")}`,placeholder:`usuario@${d.toLowerCase().replace(/[^a-z]/g,"")}.com`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${s(n,"text-gray-700","text-gray-300")}`,children:["ðŸ”‘ ContraseÃ±a del ",d]}),e.jsx("input",{type:"password",value:E[d]?.password||"",onChange:S=>I(w=>({...w,[d]:{...w[d],password:S.target.value,email:w[d]?.email||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-amber-500/20 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-amber-500","border-gray-600 bg-gray-700 text-white focus:border-amber-400")}`,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]},d))]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"Email del servicio *"}),e.jsx("input",{type:"email",value:c.service_email,onChange:d=>$({...c,service_email:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(n,"text-gray-700","text-gray-300")}`,children:"ContraseÃ±a del servicio *"}),e.jsx("input",{type:"text",value:c.service_password,onChange:d=>$({...c,service_password:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(n,"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200","bg-gradient-to-br from-amber-900/20 to-orange-900/20 border-amber-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(n,"bg-amber-100","bg-amber-900/30")}`,children:"ðŸ“"}),e.jsx("h4",{className:`text-xl font-bold ${s(n,"text-gray-900","text-white")}`,children:"Notas del Administrador"})]}),e.jsx("textarea",{value:c.admin_notes,onChange:d=>$({...c,admin_notes:d.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${s(n,"border-gray-300 bg-white text-gray-900 focus:border-amber-500 focus:ring-amber-200","border-gray-600 bg-gray-700 text-white focus:border-amber-400 focus:ring-amber-800/30")}`,rows:4,placeholder:"Escribe informaciÃ³n importante para el cliente (puedes usar saltos de lÃ­nea)..."}),e.jsx("div",{className:`mt-3 p-3 rounded-lg ${s(n,"bg-amber-100 border border-amber-200","bg-amber-900/20 border border-amber-600")}`,children:e.jsxs("p",{className:`text-sm font-semibold ${s(n,"text-amber-800","text-amber-300")}`,children:["ðŸ’¡ ",e.jsx("strong",{children:"Nota:"})," Esta informaciÃ³n serÃ¡ visible para el cliente y puede incluir instrucciones especiales, detalles de renovaciÃ³n, o cualquier informaciÃ³n relevante."]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:t,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 ${s(n,"bg-gray-200 text-gray-800 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"âŒ"}),e.jsx("span",{children:"Cancelar"})]})}),e.jsxs("button",{type:"button",onClick:C,className:`w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 ${s(n,"bg-green-500 text-white hover:bg-green-600 shadow-lg hover:shadow-xl","bg-green-600 text-white hover:bg-green-700 shadow-lg hover:shadow-xl")}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸ“±"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsxs("button",{type:"submit",className:"w-full sm:flex-1 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-200 hover:scale-105 flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’¾"}),e.jsx("span",{className:"truncate",children:"Guardar Cambios"})]})]})]})})]})})}function H(o,t,a){return o?a:t}function Ze({open:o,onClose:t,children:a,title:r,isDark:n,className:i}){return o?e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/50 p-4",onClick:t,children:e.jsxs("div",{className:`w-full max-w-lg rounded-2xl p-6 shadow-2xl ${H(n,"bg-white","bg-zinc-900")} ${i||""}`,onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold",children:r}),e.jsx("button",{onClick:t,className:`w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold transition-colors ${H(n,"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-100","text-zinc-300 hover:text-zinc-100 hover:bg-zinc-800")}`,children:"Ã—"})]}),a]})}):null}function He({isOpen:o,onClose:t,purchase:a,isDark:r,onApprove:n,onUpdatePurchase:i}){const l=a?.service||"";console.log("ðŸ” DEBUGGING - Servicio completo:",l);const x=l.trim(),b=/Disney/i.test(x)&&/(Standard|EstÃ¡ndar|Premium)/i.test(x),u=x.includes("Netflix")||x.includes("Max")||x.includes("Prime")||x.includes("Spotify")||x.includes("Paramount"),f=/\s+\+\s+/.test(x),j=b&&!u&&!f,h=f&&!j;console.log("ðŸ” DEBUGGING - Servicio:",l),console.log("ðŸ” DEBUGGING - Es servicio Disney?:",b),console.log("ðŸ” DEBUGGING - Tiene otros servicios?:",u),console.log("ðŸ” DEBUGGING - Tiene separador real?:",f),console.log("ðŸ” DEBUGGING - Es servicio individual?:",j),console.log("ðŸ” DEBUGGING - Es combo?:",h);let p=[l];h&&(l.includes("Netflix")&&l.includes("Disney")?p=["Netflix",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Max")&&l.includes("Prime")?p=["Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")?p=["Netflix","Max"]:l.includes("Netflix")&&l.includes("Prime")?p=["Netflix","Prime Video"]:l.includes("Prime")&&l.includes("Disney")?p=["Prime Video",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Disney")&&l.includes("Max")?p=[l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar","Max"]:l.includes("Spotify")&&l.includes("Netflix")?p=["Spotify","Netflix"]:l.includes("Spotify")&&l.includes("Disney")?p=["Spotify",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar"]:l.includes("Spotify")&&l.includes("Prime")?p=["Spotify","Prime Video"]:l.includes("Paramount")&&l.includes("Max")&&l.includes("Prime")?p=["Paramount+","Max","Prime Video"]:l.includes("Netflix")&&l.includes("Max")&&l.includes("Disney")?p=["Netflix","Max",l.includes("Premium")?"Disney+ Premium":"Disney+ EstÃ¡ndar","Prime Video","Paramount+"]:p=l.split(/\s*\+\s*/).map(m=>m.trim()).filter(m=>m.length>0),console.log("ðŸŽ¯ COMBO DETECTADO - Servicios separados:",p)),console.log("ðŸŽ¯ FINAL - isCombo:",h,"services:",p);const[c,$]=P.useState({email:"",password:"",notes:"",price:0}),[N,_]=P.useState({}),[E,I]=P.useState(!1);if(le.useEffect(()=>{if(o&&a)if(a.price>0)$(m=>({...m,price:a.price}));else{const m=q.find(y=>y.name===a.service)||G.find(y=>y.name===a.service);if(m){const y=m.price*(a.months||1);$(C=>({...C,price:y}))}}},[o,a]),!o||!a)return null;const T=()=>{let m="";h?m=p.map(v=>{const S=N[v];return`${v}: ${S.email} / ${S.password}`}).join(`
`):m=`Email: ${c.email}
Pass: ${c.password}`;const y=`â˜… StreamZone â˜…
Â¡Compra Aprobada! ðŸš€

Â¡Hola ${a.customer}! Tu servicio ${a.service} ya esta activo. âœ“

ðŸ”‘ CREDENCIALES:
${m}

ðŸ“… Duracion: ${a.months} ${a.months===1?"mes":"meses"}
ðŸ’Ž Â¡Disfruta tu entretenimiento!`,d=`https://api.whatsapp.com/send?phone=${B(a.phone)}&text=${encodeURIComponent(y)}`;window.open(d,"_blank")},M=async()=>{if(console.log("ðŸš€ ===== INICIANDO APROBACIÃ“N DE COMPRA ====="),console.log("ðŸ“‹ purchase:",a),console.log("ðŸ“‹ isCombo:",h),console.log("ðŸ“‹ services:",p),console.log("ðŸ“‹ serviceCredentials:",c),console.log("ðŸ“‹ multiCredentials:",N),console.log("ðŸ“‹ onApprove function:",n),console.log("ðŸ“‹ onUpdatePurchase function:",i),h){if(p.some(y=>!N[y]?.email||!N[y]?.password)){alert("Por favor completa el email y contraseÃ±a para todos los servicios del combo");return}}else if(!c.email||!c.password){alert("Por favor completa el email y contraseÃ±a del servicio");return}I(!0);try{let m,y,C;if(h){const v=p.map(S=>{const w=N[S];return`${S}:
Email: ${w.email}
ContraseÃ±a: ${w.password}`}).join(`

`);m=`COMBO: ${p.join(" + ")}`,y=v,C=c.notes}else m=c.email,y=c.password,C=c.notes;console.log("ðŸ”„ Modal: Iniciando aprobaciÃ³n...",{purchaseId:a.id,isCombo:h,emailToSave:m,passwordToSave:y?"***":"undefined",notesToSave:C});const d=await ee(a.id,m,y,C,"admin",c.price);if(console.log("ðŸ“‹ Modal: Resultado de approvePurchase:",d),d.data)console.log("âœ… Modal: Compra aprobada en Supabase, actualizando estado local..."),i&&i(a.id,{validated:!0,service_email:m,service_password:y,admin_notes:C,price:c.price}),console.log("âœ… Compra guardada en la base de datos exitosamente"),console.log("ðŸ”„ Actualizando estado local inmediatamente..."),i&&i(a.id,{validated:!0,service_email:m,service_password:y,admin_notes:C}),console.log("ðŸ”„ Llamando a onApprove para recargar datos..."),await n(),setTimeout(()=>{console.log("ðŸ”„ Cerrando modal despuÃ©s de actualizaciÃ³n..."),t(),$({email:"",password:"",notes:""}),_({})},500),alert("âœ… Compra aprobada y actualizada correctamente");else throw new Error("No se pudo guardar en la base de datos")}catch(m){console.error("Error aprobando compra:",m),alert("âŒ Error al guardar en la base de datos")}finally{I(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/60 backdrop-blur-sm p-4",onClick:t,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto ${s(r,"bg-white","bg-gray-900")}`,onClick:m=>m.stopPropagation(),children:[e.jsx("div",{className:`relative p-6 border-b-2 ${s(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-2xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Aprobar Compra"}),e.jsx("button",{onClick:t,className:`w-8 h-8 rounded-full flex items-center justify-center text-xl font-bold transition-all ${s(r,"text-gray-500 hover:bg-gray-100","text-gray-400 hover:bg-gray-700")}`,children:"Ã—"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{className:"space-y-6",children:[e.jsx("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:a.customer}),e.jsxs("p",{className:`text-lg font-semibold ${s(r,"text-gray-700","text-gray-300")}`,children:[a.service," â€¢ ",a.months," ",a.months===1?"mes":"meses"]})]}),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${s(r,"bg-blue-100","bg-blue-900/30")}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸ“±"}),e.jsx("span",{className:`font-semibold ${s(r,"text-blue-800","text-blue-200")}`,children:a.phone})]})]})}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-blue-50 border-blue-200","bg-blue-900/20 border-blue-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-blue-100","bg-blue-900/30")}`,children:"ðŸ’°"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"AuditorÃ­a de Precio"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"Confirmar Precio de Venta (Total) *"}),e.jsx("input",{type:"number",step:"0.01",value:c.price,readOnly:!0,className:`w-full rounded-xl border-2 px-4 py-3 text-lg font-bold transition-all bg-gray-100 cursor-not-allowed ${s(r,"border-gray-300 text-gray-500","border-gray-600 bg-gray-800 text-gray-400")}`,placeholder:"0.00"}),e.jsx("p",{className:`text-xs ${s(r,"text-gray-500","text-gray-400")}`,children:"Este valor se usarÃ¡ para calcular tus ingresos totales en los reportes PDF."})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-purple-50 border-purple-200","bg-purple-900/20 border-purple-700")}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s(r,"bg-yellow-100","bg-yellow-900/30")}`,children:"ðŸ”‘"}),e.jsx("h4",{className:`text-xl font-bold ${s(r,"text-gray-900","text-white")}`,children:"Credenciales del Servicio"})]}),h?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${s(r,"bg-orange-50 border border-orange-200","bg-orange-900/20 border border-orange-600")}`,children:e.jsx("p",{className:`text-sm font-semibold ${s(r,"text-orange-800","text-orange-300")}`,children:"ðŸŽ Combo detectado: Ingresa las credenciales para cada servicio"})}),p.map((m,y)=>e.jsxs("div",{className:`p-4 rounded-lg border ${s(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-600")}`,children:[e.jsxs("h5",{className:`text-lg font-bold mb-3 ${s(r,"text-gray-800","text-white")}`,children:[m," ",y===0?"ðŸŽ¬":y===1?"ðŸŽ­":y===2?"ðŸŽª":"ðŸŽ¯"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${s(r,"text-gray-700","text-gray-300")}`,children:["ðŸ“§ Email del ",m]}),e.jsx("input",{type:"email",value:N[m]?.email||"",onChange:C=>_(d=>({...d,[m]:{...d[m],email:C.target.value,password:d[m]?.password||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500/20 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-blue-500","border-gray-600 bg-gray-700 text-white focus:border-blue-400")}`,placeholder:`usuario@${m.toLowerCase().replace(/[^a-z]/g,"")}.com`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 ${s(r,"text-gray-700","text-gray-300")}`,children:["ðŸ”‘ ContraseÃ±a del ",m]}),e.jsx("input",{type:"password",value:N[m]?.password||"",onChange:C=>_(d=>({...d,[m]:{...d[m],password:C.target.value,email:d[m]?.email||""}})),className:`w-full rounded-lg border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-amber-500/20 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-amber-500","border-gray-600 bg-gray-700 text-white focus:border-amber-400")}`,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]},m))]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"Email del servicio *"}),e.jsx("input",{type:"email",value:c.email,onChange:m=>$(y=>({...y,email:m.target.value})),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`block text-sm font-bold ${s(r,"text-gray-700","text-gray-300")}`,children:"ContraseÃ±a del servicio *"}),e.jsx("input",{type:"text",value:c.password,onChange:m=>$(y=>({...y,password:m.target.value})),className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-purple-500 focus:ring-purple-200","border-gray-600 bg-gray-700 text-white focus:border-purple-400 focus:ring-purple-800/30")}`,required:!0})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl border-2 ${s(r,"bg-gray-50 border-gray-200","bg-gray-800 border-gray-700")}`,children:[e.jsx("h4",{className:`text-lg font-bold mb-4 ${s(r,"text-gray-900","text-white")}`,children:"InformaciÃ³n Importante"}),e.jsx("textarea",{value:c.notes,onChange:m=>$(y=>({...y,notes:m.target.value})),placeholder:"Notas adicionales sobre esta compra...",className:`w-full rounded-xl border-2 px-4 py-3 text-sm font-medium transition-all focus:outline-none focus:ring-2 resize-none ${s(r,"border-gray-300 bg-white text-gray-900 focus:border-gray-500 focus:ring-gray-200","border-gray-600 bg-gray-700 text-white focus:border-gray-400 focus:ring-gray-800/30")}`,rows:3})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[e.jsx("button",{onClick:t,className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 ${s(r,"bg-gray-200 text-gray-700 hover:bg-gray-300","bg-gray-700 text-gray-200 hover:bg-gray-600")}`,children:"Cancelar"}),e.jsxs("button",{onClick:T,disabled:h?p.some(m=>!N[m]?.email||!N[m]?.password):!c.email||!c.password,className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${s(r,"bg-green-500 text-white hover:bg-green-600","bg-green-600 text-white hover:bg-green-700")}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸ“±"}),e.jsx("span",{className:"truncate",children:"Enviar por WhatsApp"})]}),e.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),console.log("ðŸš€ BOTÃ“N APROBAR CLICKEADO"),console.log("ðŸ” loading:",E),console.log("ðŸ” serviceCredentials:",c),M()},disabled:E||(h?p.some(m=>!N[m]?.email||!N[m]?.password):!c.email||!c.password),className:`w-full sm:flex-1 px-6 py-3 rounded-xl font-bold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 ${s(r,"bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700 shadow-lg hover:shadow-xl","bg-gradient-to-r from-blue-600 to-purple-700 text-white hover:from-blue-700 hover:to-purple-800 shadow-lg hover:shadow-xl")}`,children:E?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"truncate",children:"Aprobando..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"âœ…"}),e.jsx("span",{className:"truncate",children:"Aprobar Compra"})]})})]})]})})]})})}export{we as A,ie as B,Re as C,Le as D,Be as E,Me as F,te as G,Te as H,De as I,Xe as J,Ue as K,He as L,Ze as M,$e as N,Fe as O,Je as P,le as R,q as S,We as a,Se as b,Ne as c,Ge as d,de as e,J as f,Q as g,K as h,re as i,e as j,ye as k,Oe as l,he as m,ve as n,G as o,Pe as p,Ie as q,P as r,g as s,s as t,_e as u,Ae as v,Ee as w,Ce as x,je as y,qe as z};
